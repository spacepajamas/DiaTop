<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.0 20120330//EN" "JATS-archivearticle1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article"><?properties open_access?><front><journal-meta><journal-id journal-id-type="nlm-ta">AAPS J</journal-id><journal-id journal-id-type="iso-abbrev">AAPS J</journal-id><journal-title-group><journal-title>The AAPS Journal</journal-title></journal-title-group><issn pub-type="epub">1550-7416</issn><publisher><publisher-name>Springer US</publisher-name><publisher-loc>New York</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="pmid">25693487</article-id><article-id pub-id-type="pmc">4406960</article-id><article-id pub-id-type="publisher-id">9718</article-id><article-id pub-id-type="doi">10.1208/s12248-015-9718-8</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories><title-group><article-title>Mixed Effects Modeling Using Stochastic Differential Equations: Illustrated by Pharmacokinetic Data of Nicotinic Acid in Obese Zucker Rats</article-title></title-group><contrib-group><contrib contrib-type="author"><name><surname>Leander</surname><given-names>Jacob</given-names></name><address><phone>+46(31) 7724297</phone><email>jacob.leander@fcc.chalmers.se</email></address><xref ref-type="aff" rid="Aff1"/><xref ref-type="aff" rid="Aff2"/></contrib><contrib contrib-type="author"><name><surname>Almquist</surname><given-names>Joachim</given-names></name><xref ref-type="aff" rid="Aff1"/><xref ref-type="aff" rid="Aff3"/></contrib><contrib contrib-type="author"><name><surname>Ahlstr&#x000f6;m</surname><given-names>Christine</given-names></name><xref ref-type="aff" rid="Aff4"/></contrib><contrib contrib-type="author"><name><surname>Gabrielsson</surname><given-names>Johan</given-names></name><xref ref-type="aff" rid="Aff5"/></contrib><contrib contrib-type="author" corresp="yes"><name><surname>Jirstrand</surname><given-names>Mats</given-names></name><address><email>mats.jirstrand@fcc.chalmers.se</email></address><xref ref-type="aff" rid="Aff1"/></contrib><aff id="Aff1"><label/>Fraunhofer-Chalmers Centre, Chalmers Science Park, SE-41288 Gothenburg, Sweden </aff><aff id="Aff2"><label/>Department of Mathematical Sciences, Chalmers University of Technology and University of Gothenburg, Gothenburg, Sweden </aff><aff id="Aff3"><label/>Systems and Synthetic Biology, Department of Biology and Biological Engineering, Chalmers University of Technology, Gothenburg, Sweden </aff><aff id="Aff4"><label/>CVMD iMed DMPK, AstraZeneca R&#x00026;D, M&#x000f6;lndal, Sweden </aff><aff id="Aff5"><label/>Division of Pharmacology and Toxicology, Department of Biomedical Sciences and Veterinary Public Health, Swedish University of Agricultural Sciences, Uppsala, Sweden </aff></contrib-group><pub-date pub-type="epub"><day>19</day><month>2</month><year>2015</year></pub-date><pub-date pub-type="pmc-release"><day>19</day><month>2</month><year>2015</year></pub-date><pub-date pub-type="collection"><month>5</month><year>2015</year></pub-date><volume>17</volume><issue>3</issue><fpage>586</fpage><lpage>596</lpage><history><date date-type="received"><day>22</day><month>8</month><year>2014</year></date><date date-type="accepted"><day>25</day><month>11</month><year>2014</year></date></history><permissions><copyright-statement>&#x000a9; The Author(s) 2015</copyright-statement><license license-type="OpenAccess"><license-p>
<bold>Open Access</bold> This article is distributed under the terms of the Creative Commons Attribution License which permits any use, distribution, and reproduction in any medium, provided the original author(s) and the source are credited.</license-p></license></permissions><abstract id="Abs1"><p>Inclusion of stochastic differential equations in mixed effects models provides means to quantify and distinguish three sources of variability in data. In addition to the two commonly encountered sources, measurement error and interindividual variability, we also consider uncertainty in the dynamical model itself. To this end, we extend the ordinary differential equation setting used in nonlinear mixed effects models to include stochastic differential equations. The approximate population likelihood is derived using the first-order conditional estimation with interaction method and extended Kalman filtering. To illustrate the application of the stochastic differential mixed effects model, two pharmacokinetic models are considered. First, we use a stochastic one-compartmental model with first-order input and nonlinear elimination to generate synthetic data in a simulated study. We show that by using the proposed method, the three sources of variability can be successfully separated. If the stochastic part is neglected, the parameter estimates become biased, and the measurement error variance is significantly overestimated. Second, we consider an extension to a stochastic pharmacokinetic model in a preclinical study of nicotinic acid kinetics in obese Zucker rats. The parameter estimates are compared between a deterministic and a stochastic NiAc disposition model, respectively. Discrepancies between model predictions and observations, previously described as measurement noise only, are now separated into a comparatively lower level of measurement noise and a significant uncertainty in model dynamics. These examples demonstrate that stochastic differential mixed effects models are useful tools for identifying incomplete or inaccurate model dynamics and for reducing potential bias in parameter estimates due to such model deficiencies.</p></abstract><kwd-group xml:lang="en"><title>KEY WORDS</title><kwd>extended Kalman filter</kwd><kwd>model uncertainty</kwd><kwd>nonlinear kinetics</kwd><kwd>parameter estimation</kwd><kwd>state prediction</kwd></kwd-group><custom-meta-group><custom-meta><meta-name>issue-copyright-statement</meta-name><meta-value>&#x000a9; American Association of Pharmaceutical Scientists 2015</meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="Sec1" sec-type="introduction"><title>INTRODUCTION</title><p>In pharmacokinetic and pharmacodynamic modeling, the physical system is often assumed to be described by a system of ordinary differential equations (ODEs). In pharmacokinetics, compartmental models are mostly used, whereas for pharmacodynamics, direct or turnover response models are common (<xref ref-type="bibr" rid="CR1">1</xref>). The observed data are assumed to arise from a deterministic process under some measurement noise (additive, proportional, a combination of the two, or more general probabilistic models). However, the use of deterministic modeling approaches for describing the dynamics often suffers from limited and uncertain knowledge regarding the details of such processes. Since it is up to the modeler to define a model describing the drug administration and its effect, there is also an uncertainty in the model itself. This uncertainty is not explicitly accounted for when considering a deterministic model, for example when using ODEs to describe the dynamics together with a measurement model to incorporate the error. This can lead to model deficiencies, such as correlated residuals, overestimated measurement noise, and incorrect inference (<xref ref-type="bibr" rid="CR2">2</xref>).</p><p>Nonlinear mixed effects (NLME) models were introduced into the pharmaceutical field to analyze data from several individuals simultaneously (<xref ref-type="bibr" rid="CR3">3</xref>&#x02013;<xref ref-type="bibr" rid="CR5">5</xref>). The individuals are assumed to be described by a common structural model with some of the model parameters varying within the population (so-called random effects parameters), while other parameters are invariant between subjects (so-called fixed effects parameters). The NLME approach can be of great benefit when the data is sparse and the information from a single subject is not sufficient to identify the model parameters. It is typically performed using a deterministic model describing the underlying system, for example by utilizing ODEs (<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>).</p><p>We consider the extension of the NLME approach to allow for uncertainty in the model dynamics. This is done by considering stochastic differential equations (SDEs), which is an extension of ODEs to allow for a random part in the model dynamics. This approach has previously been advocated, see for example (<xref ref-type="bibr" rid="CR8">8</xref>&#x02013;<xref ref-type="bibr" rid="CR10">10</xref>). We have previously also demonstrated the benefits of using SDEs when solving the inverse problem of parameter estimation (<xref ref-type="bibr" rid="CR11">11</xref>). SDEs can furthermore be used to model the inherent randomness in pharmacokinetic and pharmacodynamic systems (<xref ref-type="bibr" rid="CR12">12</xref>, <xref ref-type="bibr" rid="CR13">13</xref>), as an alternative to discrete models using a master equation approach and the Gillespie algorithm (<xref ref-type="bibr" rid="CR14">14</xref>&#x02013;<xref ref-type="bibr" rid="CR16">16</xref>). Also, in systems without true randomness, SDEs can be used to model an incomplete or imperfect model structure. SDEs (see (<xref ref-type="bibr" rid="CR17">17</xref>, <xref ref-type="bibr" rid="CR18">18</xref>) for references) have long been used in mathematical finance, for example to model the uncertainty in an asset (<xref ref-type="bibr" rid="CR19">19</xref>). In contrast to the classical approach, where data variability arises from the measurements and the variability in parameters, a stochastic model also incorporates errors in the dynamics itself. Hence, this kind of modeling allows for three different sources of variability: population variability, measurement error, and system noise.</p><p>One often faces the inverse problem of estimating model parameters from observed noisy data. There are several approaches to the delicate problem of estimating parameters in stochastic differential mixed effects models. In general, there is no closed form solution of the likelihood function. Approaches to the parameter estimation problem on a population level include for example the first-order (FO) and the first-order conditional estimation (FOCE) method (<xref ref-type="bibr" rid="CR20">20</xref>, <xref ref-type="bibr" rid="CR21">21</xref>) and stochastic approximation of expectation maximization (SAEM) method (<xref ref-type="bibr" rid="CR22">22</xref>). State estimation on an individual level includes, for example, the Kalman filter (KF), the extended Kalman filter (EKF), and particle filters. For a combination of the FOCE approximation of the population likelihood and the EKF, see for example (<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR23">23</xref>&#x02013;<xref ref-type="bibr" rid="CR25">25</xref>). In (<xref ref-type="bibr" rid="CR26">26</xref>), the authors propose a combination of the SAEM algorithm and EKF. For a review of parameter estimation methods in SDE population models, see (<xref ref-type="bibr" rid="CR27">27</xref>).</p><p>In this paper, we consider approximation of the population likelihood by using the first-order conditional estimation with interaction (FOCEI) approximation of the population likelihood together with the EKF for state estimation on the individual level. In contrast to previous efforts (<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR23">23</xref>&#x02013;<xref ref-type="bibr" rid="CR25">25</xref>), we estimate the full covariance matrix describing population variability. That is, we allow for correlation between random parameters in the model. By utilizing the FOCEI method, we allow for interaction between output variance and random parameters. Furthermore, instead of adopting the commonly used finite difference approximation, we make use of sensitivity equations to evaluate the gradient of the objective function in the optimization procedure, previously mentioned in (<xref ref-type="bibr" rid="CR28">28</xref>). Moreover, we produce illustrative plots describing state variable uncertainty and output uncertainty (which is a combination of state and measurement uncertainty). These plots serve as diagnostic tools of model appropriateness and illustration of the uncertainty in model output.</p><p>The extension of ODEs to SDEs is illustrated using two examples of pharmacokinetic data. First, a stochastic one-compartmental pharmacokinetic model with first-order input and nonlinear elimination is considered by using a simulated data set consisting of 20 animals. Since we now account for three sources of variability in data, it is important to know if the three sources can be distinguished from each other. From the simulated data, the parameters of the model are estimated, including the system noise and the covariance matrices describing measurement error and parameter variability. Second, we consider a data set from a preclinical study of nicotinic acid (NiAc) turnover in obese rats, where the original NiAc disposition model and a NiAc disposition model extended to an SDE model are compared in terms of parameter estimates and model prediction.</p></sec><sec id="Sec2" sec-type="materials|methods"><title>MATERIALS AND METHODS</title><sec id="Sec3"><title>Mathematical Theory</title><p>In this section, we state the stochastic mixed effects model and derive the (approximate) maximum likelihood theory needed for parameter estimation. This section is recommended for readers not familiar with the concept of SDEs. We also introduce the concept of the EKF, which serves as a state estimator for the stochastic model (<xref ref-type="bibr" rid="CR29">29</xref>).</p><sec id="Sec4"><title>The Stochastic Mixed Effects Model Framework</title><p>In population modeling, NLME models are used to describe data of the form<disp-formula id="Equ1"><label>1</label><alternatives><tex-math id="M1">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{y}}_{ij},i=1, \dots, N,j=1,\dots, {n}_i, $$\end{document}</tex-math><mml:math id="M2"><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>&#x02026;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ1.gif" position="anchor"/></alternatives></disp-formula></p><p>where the vector <bold><italic>y</italic></bold><sub><italic>ij</italic></sub> denotes the <italic>j</italic>:th observation for the <italic>i</italic>:th individual. The statistical model is the following<disp-formula id="Equ2"><label>2</label><alternatives><tex-math id="M3">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ d{\boldsymbol{x}}_i=\boldsymbol{f}\left({\boldsymbol{x}}_i,{\boldsymbol{u}}_i,t,{\boldsymbol{\phi}}_i\right)dt,{\boldsymbol{x}}_i(0)={\boldsymbol{x}}_0\left({\boldsymbol{\phi}}_i\right) $$\end{document}</tex-math><mml:math id="M4" display="block"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ2.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ3"><label>3</label><alternatives><tex-math id="M5">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{y}}_{ij}=\boldsymbol{h}\left({\boldsymbol{x}}_i,{\boldsymbol{u}}_i,{t}_{ij},{\boldsymbol{\phi}}_i\right)+{\boldsymbol{e}}_{ij}, $$\end{document}</tex-math><mml:math id="M6" display="block"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ3.gif" position="anchor"/></alternatives></disp-formula>where time is denoted by <italic>t</italic>. Note that the differential equation is written in differential form, which is the standard notation for SDEs that will be introduced later on. The vector-valued function <bold><italic>f</italic></bold>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub>,&#x02009;<bold><italic>u</italic></bold><sub><italic>i</italic></sub>,&#x02009;<italic>t</italic>,&#x02009;<bold><italic>&#x003d5;</italic></bold><sub><italic>i</italic></sub>) describes the dynamics of the system, and <bold><italic>&#x003d5;</italic></bold><sub><italic>i</italic></sub> denotes the individual parameters for individual <italic>i</italic>. The state variables of the system are denoted <bold><italic>x</italic></bold><sub><italic>i</italic></sub> and may for example be the concentration of a drug or drug effect. The input to the system is denoted <bold><italic>u</italic></bold><sub><italic>i</italic></sub>, which for example can be an infusion. Measurements are assumed to be taken at discrete points in time and characterized by the measurement function <bold><italic>h</italic></bold>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub>,&#x02009;<bold><italic>u</italic></bold><sub><italic>i</italic></sub>,&#x02009;<italic>t</italic><sub><italic>ij</italic></sub>,&#x02009;<bold><italic>&#x003d5;</italic></bold><sub><italic>i</italic></sub>) and the measurement error <bold><italic>e</italic></bold><sub><italic>ij</italic></sub>&#x02009;~&#x02009;<italic>N</italic>(<bold>0</bold>,&#x02009;<bold><italic>S</italic></bold>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub>,&#x02009;<bold><italic>u</italic></bold><sub><italic>i</italic></sub>,&#x02009;<italic>t</italic><sub><italic>ij</italic></sub>,&#x02009;<bold><italic>&#x003d5;</italic></bold><sub><italic>i</italic></sub>)).</p><p>The individual parameters <bold><italic>&#x003d5;</italic></bold><sub><italic>i</italic></sub> are related to the population parameters <bold><italic>&#x003b8;</italic></bold> according to<disp-formula id="Equa"><alternatives><tex-math id="M7">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{\phi}}_i=\boldsymbol{g}\left(\boldsymbol{\theta}, {\boldsymbol{Z}}_i,{\boldsymbol{\eta}}_i\right), $$\end{document}</tex-math><mml:math id="M8" display="block"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">g</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">Z</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Equa.gif" position="anchor"/></alternatives></disp-formula>where <bold><italic>&#x003b8;</italic></bold> denote the fixed effect parameters, <bold><italic>Z</italic></bold><sub><italic>i</italic></sub> denote the covariates for individual i and <bold><italic>&#x003b7;</italic></bold><sub><italic>i</italic></sub>&#x02009;~&#x02009;N(<bold>0</bold>,&#x02009;<bold>&#x003a9;</bold>) are the random effects for individual <italic>i</italic>, which are assumed to be multivariate normal distributed with mean zero and covariance <bold>&#x003a9;</bold>. The model described above is the commonly used NLME model setup, and we refer the reader to (<xref ref-type="bibr" rid="CR6">6</xref>, <xref ref-type="bibr" rid="CR7">7</xref>) for more information.</p><p>Instead of considering the deterministic model in the classic framework, we want to include some kind of uncertainty in the differential equations as well. This is achieved by expanding the ODEs to SDEs. The stochastic differential mixed effect model, abbreviated SDMEM (<xref ref-type="bibr" rid="CR30">30</xref>), is defined as<disp-formula id="Equ4"><label>4</label><alternatives><tex-math id="M9">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ d{\boldsymbol{x}}_i=\boldsymbol{f}\left({\boldsymbol{x}}_i,{\boldsymbol{u}}_i,t,{\boldsymbol{\phi}}_i\right)dt+\boldsymbol{\Sigma} \left({\boldsymbol{x}}_i,{\boldsymbol{u}}_i,t,{\boldsymbol{\phi}}_i\right)d{\boldsymbol{W}}_i,\kern0.5em {\boldsymbol{x}}_i(0)={\boldsymbol{x}}_0\left({\boldsymbol{\phi}}_i\right) $$\end{document}</tex-math><mml:math id="M10" display="block"><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="bold">&#x003a3;</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">W</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.5em"/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ4.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ5"><label>5</label><alternatives><tex-math id="M11">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{y}}_{ij}=\boldsymbol{h}\left({\boldsymbol{x}}_i,{\boldsymbol{u}}_i,{t}_{ij},{\boldsymbol{\phi}}_i\right)+{\boldsymbol{e}}_{ij}. $$\end{document}</tex-math><mml:math id="M12" display="block"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">e</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ5.gif" position="anchor"/></alternatives></disp-formula></p><p>An SDE of the form (4) consists of two parts. First, we have the so-called drift function <bold><italic>f</italic></bold>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub>,&#x02009;<bold><italic>u</italic></bold><sub><italic>i</italic></sub>,&#x02009;<italic>t</italic>,&#x02009;<bold><italic>&#x003d5;</italic></bold><sub><italic>i</italic></sub>) corresponding to the deterministic part in the model, which is the same as in Eq. (<xref rid="Equ2" ref-type="">2</xref>). Second, we have the random term <bold>&#x003a3;</bold>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub>,&#x02009;<bold><italic>u</italic></bold><sub><italic>i</italic></sub>, <italic>t</italic>,&#x02009;<bold><italic>&#x003d5;</italic></bold><sub><italic>i</italic></sub>)<italic>d</italic><bold><italic>W</italic></bold><sub><italic>i</italic></sub>, which corresponds to the uncertain part of the model. We will later refer to <bold>&#x003a3;</bold>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub>,&#x02009;<bold><italic>u</italic></bold><sub><italic>i</italic></sub>,&#x02009;<italic>t</italic>,&#x02009;<bold><italic>&#x003d5;</italic></bold><sub><italic>i</italic></sub>)<italic>d</italic><bold><italic>W</italic></bold><sub><italic>i</italic></sub> as the system noise. The system noise is a continuous stochastic process, in contrast to the measurement noise, which is realized at discrete time points. In Eq. (<xref rid="Equ4" ref-type="">4</xref>), <italic>d</italic><bold><italic>W</italic></bold><sub><italic>i</italic></sub> corresponds to the increment of a q-dimensional Wiener process <bold><italic>W</italic></bold><sub><italic>i</italic></sub>. The elements of <italic>d</italic><bold><italic>W</italic></bold><sub><italic>i</italic></sub> are independent and normally distributed with mean zero and variance <italic>d</italic><italic>t</italic>. Moreover, the Wiener increments <italic>d</italic><bold><italic>W</italic></bold><sub><italic>i</italic></sub> are considered independent across individuals and independent of the measurement error.</p><p>In contrast to the classic approach, where the only error arises in the measurement equation, an SDE setting provides a flexible framework to account for fluctuations in the underlying state variables. The system noise is a tool that accounts for all the unknown phenomena that are not captured by the deterministic model, for example approximations, modeling errors, and oversimplifications. In a mixed effects model setting, variability in response can now arise from three different sources, namely measurement noise, system noise, and parameter variability.</p></sec><sec id="Sec5"><title>Parameter Estimation in the Stochastic Mixed Effects Population Framework</title><p>Given a collection of measurements of the form (2) and an underlying model of the form (4)&#x02013;(5), the model parameters can be estimated using the maximum likelihood approach. This has previously been elaborated, see, e.g., (<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR25">25</xref>). For convenience of the reader, we here provide the necessary equations together with the extension to models with interaction between random effects and output covariance.</p><p>For a specific individual <italic>i</italic>, the optimal parameter values are found by maximizing the individual likelihood. Using the notation <italic>Y</italic><sub><italic>ik</italic></sub>&#x02009;=&#x02009;[<bold><italic>y</italic></bold><sub><italic>i</italic>1</sub>,&#x02009;<bold><italic>y</italic></bold><sub><italic>i</italic>2</sub>,&#x02002;&#x02026;, <bold><italic>y</italic></bold><sub><italic>ik</italic></sub>] to denote the measurements up to time point <italic>t</italic><sub><italic>k</italic></sub> for individual <italic>i</italic>, the combined likelihood becomes<disp-formula id="Equb"><alternatives><tex-math id="M13">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {L}_i\left(\boldsymbol{\theta} \Big|{Y}_{i{n}_i}\right)=\left(\prod_{j=2}^{n_i}p\left({\boldsymbol{y}}_{ij}\Big|{Y}_{i\left(j-1\right)},\boldsymbol{\theta} \right)\right)p\left({\boldsymbol{y}}_{i1}\Big|\boldsymbol{\theta} \right) $$\end{document}</tex-math><mml:math id="M14" display="block"><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover></mml:mstyle></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12248_2015_9718_Article_Equb.gif" position="anchor"/></alternatives></disp-formula>where the probability for an observation given the previous observations and the parameters is <italic>p</italic>(<bold><italic>y</italic></bold><sub><italic>ij</italic></sub>|<italic>Y</italic><sub><italic>i</italic>(<italic>j</italic>&#x02009;&#x02212;&#x02009;1)</sub>,&#x02009;<bold><italic>&#x003b8;</italic></bold>). Assuming Gaussian densities, which are characterized by their first and second moments denoted by<disp-formula id="Equc"><alternatives><tex-math id="M15">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l}{\widehat{\boldsymbol{y}}}_{ij}=E\left({\boldsymbol{y}}_{ij}\Big|{Y}_{i\left(j-1\right)},\boldsymbol{\theta} \right)\hfill \\ {}{\boldsymbol{R}}_{ij}=Var\left({\boldsymbol{y}}_{ij}\Big|{Y}_{i\left(j-1\right)},\boldsymbol{\theta} \right),\hfill \end{array} $$\end{document}</tex-math><mml:math id="M16"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow></mml:mfenced></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:msub><mml:mi mathvariant="bold-italic">R</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi>j</mml:mi><mml:mo>-</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfenced></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mrow></mml:mfenced><mml:mtext>,</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12248_2015_9718_Article_Equc.gif" position="anchor"/></alternatives></disp-formula>we can write down the individual likelihood. Taking the logarithm, the individual log-likelihood is given by<disp-formula id="Equd"><alternatives><tex-math id="M17">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \log {L}_i\left(\boldsymbol{\theta} \Big|{Y}_{i{n}_i}\right)=-\frac{1}{2}{\displaystyle \sum_{j=1}^{n_i}}\left({\boldsymbol{\epsilon}}_{ij}^T{\boldsymbol{R}}_{ij}^{-1}{\boldsymbol{\epsilon}}_{ij}+ \log \left|2\pi {\boldsymbol{R}}_{ij}\right|\right), $$\end{document}</tex-math><mml:math id="M18" display="block"><mml:mi>log</mml:mi><mml:msub><mml:mrow><mml:mi>L</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover></mml:mstyle></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Equd.gif" position="anchor"/></alternatives></disp-formula>where<disp-formula id="Eque"><alternatives><tex-math id="M19">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{\epsilon}}_{ij}={\boldsymbol{y}}_{ij}-{\hat{\boldsymbol{y}}}_{ij}, $$\end{document}</tex-math><mml:math id="M20" display="block"><mml:msub><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Eque.gif" position="anchor"/></alternatives></disp-formula>is the prediction error, assumed to be normal distributed with mean <bold>0</bold> and variance <bold><italic>R</italic></bold><sub><italic>ij</italic></sub>. We denote the collection of all individual measurements <inline-formula id="IEq1"><alternatives><tex-math id="M21">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Y=\left\{{Y}_{1{n}_1},{Y}_{2{n}_2},\dots, {Y}_{N{n}_N}\right\} $$\end{document}</tex-math><mml:math id="M22"><mml:mi>Y</mml:mi><mml:mo>=</mml:mo><mml:mfenced close="}" open="{" separators=",,,"><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>&#x02026;</mml:mo><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mfenced></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq1.gif"/></alternatives></inline-formula>. The population likelihood is simply a product of individual likelihoods,<disp-formula id="Equf"><alternatives><tex-math id="M23">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L\left(\boldsymbol{\theta} \Big|Y\right)=\prod_{i=1}^Np\left({Y}_{i{n}_i}\Big|\boldsymbol{\theta}, \boldsymbol{\Omega} \right) $$\end{document}</tex-math><mml:math id="M24" display="block"><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mstyle><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover></mml:mstyle></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mrow><mml:mi>n</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">&#x003a9;</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><graphic xlink:href="12248_2015_9718_Article_Equf.gif" position="anchor"/></alternatives></disp-formula></p><p>Since the random effects are unobserved quantities, we marginalize over the random effects,<disp-formula id="Equ6"><label>6</label><alternatives><tex-math id="M25">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L\left(\boldsymbol{\theta} \Big|Y\right)=\prod_{i=1}^N{\displaystyle \int }p\left({Y}_{i{n}_i}\Big|\boldsymbol{\theta}, {\boldsymbol{\eta}}_i\right)p\left({\boldsymbol{\eta}}_i\Big|\boldsymbol{\Omega} \right)d{\boldsymbol{\eta}}_i=\prod_{i=1}^N \exp \left({l}_i\right)d{\boldsymbol{\eta}}_i, $$\end{document}</tex-math><mml:math id="M26"><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced><mml:mo>=</mml:mo><mml:mrow><mml:mstyle><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover></mml:mstyle></mml:mrow><mml:mstyle displaystyle="true"><mml:mo stretchy="true">&#x0222b;</mml:mo></mml:mstyle><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>p</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="true">|</mml:mo><mml:mi mathvariant="bold">&#x003a9;</mml:mi></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mstyle><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover></mml:mstyle></mml:mrow><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mi>d</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ6.gif" position="anchor"/></alternatives></disp-formula>where <inline-formula id="IEq2"><alternatives><tex-math id="M27">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {l}_i={l}_i\left({\boldsymbol{\eta}}_i\right)={l}_i\left({\boldsymbol{\eta}}_i;{Y}_{i{n}_i},\boldsymbol{\theta} \right) $$\end{document}</tex-math><mml:math id="M28"><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mo>=</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="(" separators=";,"><mml:msub><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>Y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:mfenced></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq2.gif"/></alternatives></inline-formula> is the <italic>a posteriori</italic> log-likelihood for the random effects of the <italic>i</italic>:th individual<disp-formula id="Equ7"><label>7</label><alternatives><tex-math id="M29">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {l}_i=-\frac{1}{2}{\displaystyle \sum_{j=1}^{n_i}}\left({\boldsymbol{\epsilon}}_{ij}^T{\boldsymbol{R}}_{ij}^{-1}{\boldsymbol{\epsilon}}_{ij}+ \log \left|2\pi {\boldsymbol{R}}_{ij}\right|\right)-\frac{1}{2}{\boldsymbol{\eta}}_i^T{\boldsymbol{\Omega}}^{-1}{\boldsymbol{\eta}}_i-\frac{1}{2} \log \left|2\pi \boldsymbol{\Omega} \right|, $$\end{document}</tex-math><mml:math id="M30" display="block"><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover></mml:mstyle></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mrow><mml:mi mathvariant="bold">&#x003a9;</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>log</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi><mml:mi mathvariant="bold">&#x003a9;</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ7.gif" position="anchor"/></alternatives></disp-formula></p><p>In most cases, there is no closed form expression for the integral in Eq. (<xref rid="Equ6" ref-type="">6</xref>). The integral can be approximated using the Laplace approximation, see (<xref ref-type="bibr" rid="CR31">31</xref>&#x02013;<xref ref-type="bibr" rid="CR33">33</xref>). The Laplace approximation uses a second-order Taylor expansion of <italic>l</italic><sub><italic>i</italic></sub> around a point <bold><italic>&#x003b7;</italic></bold><sub arrange="stack"><italic>i</italic></sub><sup arrange="stack">*</sup>. Here, the point is chosen to be the value of <bold><italic>&#x003b7;</italic></bold><sub><italic>i</italic></sub> which maximizes the individual log-likelihood (7),<disp-formula id="Equg"><alternatives><tex-math id="M31">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{\eta}}_i^{\ast }=\underset{{\boldsymbol{\eta}}_i}{ \arg \kern0.15em  \max}\kern0.28em {l}_i\left({\boldsymbol{\eta}}_i\right). $$\end{document}</tex-math><mml:math id="M32" display="block"><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi></mml:mrow><mml:mi>i</mml:mi><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>arg</mml:mi><mml:mspace width="0.15em"/><mml:mo movablelimits="true">max</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub></mml:munder><mml:mspace width="thickmathspace"/><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Equg.gif" position="anchor"/></alternatives></disp-formula></p><p>Using this <bold><italic>&#x003b7;</italic></bold><sub arrange="stack"><italic>i</italic></sub><sup arrange="stack">*</sup>, we end up with the approximate population likelihood function<disp-formula id="Equh"><alternatives><tex-math id="M33">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ L\left(\boldsymbol{\theta} \Big|Y\right)\approx \prod_{i=1}^N \exp \left({l}_i\left({\boldsymbol{\eta}}_i^{\ast}\right)\right)\left|\frac{-\Delta {l}_i\left({\boldsymbol{\eta}}_i^{*}\right)}{2\pi}\right|, $$\end{document}</tex-math><mml:math id="M34" display="block"><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02248;</mml:mo><mml:mrow><mml:mstyle><mml:munderover><mml:mo>&#x0220f;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover></mml:mstyle></mml:mrow><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mo>&#x02217;</mml:mo></mml:mrow></mml:msubsup><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfenced close="|" open="|"><mml:mfrac><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Equh.gif" position="anchor"/></alternatives></disp-formula>where &#x00394;<italic>l</italic><sub><italic>i</italic></sub>(<bold><italic>&#x003b7;</italic></bold><sub arrange="stack"><italic>i</italic></sub><sup arrange="stack">*</sup>) denotes the Hessian of the individual log-likelihood (7) evaluated at the point <bold><italic>&#x003b7;</italic></bold><sub arrange="stack"><italic>i</italic></sub><sup arrange="stack">*</sup>. Taking the logarithm, we have<disp-formula id="Equi"><alternatives><tex-math id="M35">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \log L\left(\boldsymbol{\theta} \Big|Y\right)\approx {\displaystyle \sum_{i=1}^N}{l}_i\left({\boldsymbol{\eta}}_i^{*}\right)-\frac{1}{2} \log \left|\frac{-\Delta {l}_i\left({\boldsymbol{\eta}}_i^{*}\right)}{2\pi}\right|. $$\end{document}</tex-math><mml:math id="M36"><mml:mo>log</mml:mo><mml:mi>L</mml:mi><mml:mfenced close=")" open="("><mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo stretchy="true">|</mml:mo><mml:mi>Y</mml:mi></mml:mrow></mml:mfenced><mml:mo>&#x02248;</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover></mml:mstyle><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mfenced><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>log</mml:mo><mml:mfenced close="|" open="|"><mml:mfrac><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mi>l</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mi>i</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mfenced></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>&#x003c0;</mml:mi></mml:mrow></mml:mfrac></mml:mfenced><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12248_2015_9718_Article_Equi.gif" position="anchor"/></alternatives></disp-formula></p><p>The expression for the element at index <italic>l</italic>,&#x02009;<italic>k</italic> of the Hessian matrix is<disp-formula id="Equj"><alternatives><tex-math id="M37">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{c}\kern1em {\left(\varDelta {l}_i\left(\boldsymbol{\eta} \right)\right)}_{l,k}=\frac{\partial^2{l}_i\left(\boldsymbol{\eta} \right)}{\partial {\eta}_l\partial {\eta}_k}\kern1em \\ {}\kern1em \approx -{\displaystyle \sum_{j=1}^{n_i}\frac{\partial {\boldsymbol{\epsilon}}_{ij}^T}{\partial {\eta}_l}{\boldsymbol{R}}_{ij}^{-1}\frac{\partial {\boldsymbol{\epsilon}}_{ij}}{\partial {\eta}_k}+{\boldsymbol{\epsilon}}_{ij}^T{\boldsymbol{R}}_{ij}^{-1}\frac{\partial {\boldsymbol{R}}_{ij}}{\partial {\eta}_l}{\boldsymbol{R}}_{ij}^{-1}\frac{\partial {\boldsymbol{\epsilon}}_{ij}^T}{\partial {\eta}_k}+\frac{\partial {\boldsymbol{\epsilon}}_{ij}^T}{\partial {\eta}_k}{\boldsymbol{R}}_{ij}^{-1}{\boldsymbol{\epsilon}}_{ij}}\kern1em \\ {}\kern1em -{\boldsymbol{\epsilon}}_{ij}^T{\boldsymbol{R}}_{ij}^{-1}\frac{\partial {\boldsymbol{R}}_{ij}}{\partial {\eta}_l}{\boldsymbol{R}}_{ij}^{-1}\frac{\partial {\boldsymbol{R}}_{ij}}{\partial {\eta}_k}{\boldsymbol{\epsilon}}_{ij}-\frac{1}{2}Tr\left(-{\boldsymbol{R}}_{ij}^{-1}\frac{\partial {\boldsymbol{R}}_{ij}}{\partial {\eta}_l}{\boldsymbol{R}}_{ij}^{-1}\frac{\partial {\boldsymbol{R}}_{ij}}{\partial {\eta}_k}\right)-{\varOmega}_{l,k}^{-1},\kern1em \end{array} $$\end{document}</tex-math><mml:math id="M38" display="block"><mml:mtable columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>&#x00394;</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow><mml:mo>&#x02248;</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msub><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mstyle></mml:mrow><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>T</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mrow><mml:mi>&#x003a9;</mml:mi></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12248_2015_9718_Article_Equj.gif" position="anchor"/></alternatives></disp-formula>where only first-order partial derivatives are considered and higher-order contributions are assumed to be negligible in the calculation of the Hessian &#x00394;<italic>l</italic><sub><italic>i</italic></sub>(<italic>&#x003b7;</italic>). This is called the FOCEI approximation. If we assume no interaction between the output covariance <bold><italic>R</italic></bold><sub><italic>ij</italic></sub> and the random parameters, the approximate Hessian is given by<disp-formula id="Equ8"><label>9</label><alternatives><tex-math id="M39">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\left(\Delta {l}_i\left(\boldsymbol{\eta} \right)\right)}_{l,k}=\frac{\partial^2{l}_i\left(\boldsymbol{\eta} \right)}{\partial {\eta}_l\partial {\eta}_k}\approx -{\displaystyle \sum_{j=1}^{n_i}}\frac{\partial {\boldsymbol{\epsilon}}_{ij}^T}{\partial {\eta}_l}{\boldsymbol{R}}_{ij}^{-1}\frac{\partial {\boldsymbol{\epsilon}}_{ij}}{\partial {\eta}_k}-{\Omega}_{l,k}^{-1}, $$\end{document}</tex-math><mml:math id="M40" display="block"><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="normal">&#x00394;</mml:mi><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mrow><mml:mi>l</mml:mi></mml:mrow><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b7;</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x02248;</mml:mo><mml:mo>&#x02212;</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo stretchy="true">&#x02211;</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munderover></mml:mstyle></mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msubsup><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>l</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mi>&#x003b7;</mml:mi></mml:mrow></mml:mrow><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>&#x02212;</mml:mo><mml:msubsup><mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x003a9;</mml:mi></mml:mrow></mml:mrow><mml:mrow><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>,</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ8.gif" position="anchor"/></alternatives></disp-formula></p><p>referred to as the FOCE method (<xref ref-type="bibr" rid="CR33">33</xref>). Finally, the maximum likelihood estimates are given by maximizing the approximate population likelihood as<disp-formula id="Equ9"><label>10</label><alternatives><tex-math id="M41">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \widehat{\boldsymbol{\theta}}=\underset{\boldsymbol{\theta}}{ \arg \kern0.15em  \max } \log \kern0.15em L\left(\boldsymbol{\theta} \Big|Y\right). $$\end{document}</tex-math><mml:math id="M42" display="block"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>arg</mml:mi><mml:mspace width="0.15em"/><mml:mo movablelimits="true">max</mml:mo></mml:mrow><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi></mml:munder><mml:mi>log</mml:mi><mml:mspace width="0.15em"/><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">&#x003b8;</mml:mi><mml:mrow><mml:mo stretchy="true">|</mml:mo></mml:mrow><mml:mi>Y</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ9.gif" position="anchor"/></alternatives></disp-formula></p><p>Due to the stochastic part of the model in Eqs. (<xref rid="Equ4" ref-type="">4</xref>)&#x02013;(<xref rid="Equ5" ref-type="">5</xref>), the state of the system is uncertain. There are several solutions to the state estimation problem in these situations, including for example particle filters and the Kalman filter (<xref ref-type="bibr" rid="CR29">29</xref>). In this paper, we will utilize the so-called extended Kalman filter (EKF).</p></sec><sec id="Sec6"><title>The Continuous Discrete Extended Kalman Filter</title><p>To calculate the individual log-likelihoods (7), we need the prediction errors <bold><italic>&#x003f5;</italic></bold><sub><italic>ij</italic></sub> and the output covariance matrices <bold><italic>R</italic></bold><sub><italic>ij</italic></sub>. As noted in (<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR25">25</xref>), these identities can be recursively computed using the extended Kalman filter (EKF).</p><p>The continuous discrete EKF is a state estimator for continuous discrete state space models of the form (4)&#x02013;(5) (<xref ref-type="bibr" rid="CR29">29</xref>). From observations, the state variables of the system and their covariance are estimated in order to compute the residuals and the output covariance. From now on, we drop the individual notation <italic>i</italic>.</p><p>The EKF is an extension of the famous Kalman filter to nonlinear models (<xref ref-type="bibr" rid="CR34">34</xref>). For linear dynamic models, the Kalman filter provides an optimal state estimator for a given parameter vector <bold><italic>&#x003d5;</italic></bold>. For nonlinear models, the EKF uses a first-order linearization around the model trajectory. The EKF provides estimates of the conditional expectation of the state <inline-formula id="IEq3"><alternatives><tex-math id="M43">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{x}}}_{k|k}=E\left({\boldsymbol{x}}_{t_k}\Big|{Y}_k,\boldsymbol{\phi} \right) $$\end{document}</tex-math><mml:math id="M44" display="block"><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq3.gif"/></alternatives></inline-formula> and its covariance <inline-formula id="IEq4"><alternatives><tex-math id="M45">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{P}}_{k|k}=Var\left({\boldsymbol{x}}_{t_k}\Big|{Y}_k,\boldsymbol{\phi} \right) $$\end{document}</tex-math><mml:math id="M46" display="block"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>V</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mi>Y</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq4.gif"/></alternatives></inline-formula>. Given initial conditions <inline-formula id="IEq5"><alternatives><tex-math id="M47">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\hat{\boldsymbol{x}}}_{1|0}={\boldsymbol{x}}_0 $$\end{document}</tex-math><mml:math id="M48" display="block"><mml:msub><mml:mrow><mml:mrow><mml:mover><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:msub></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq5.gif"/></alternatives></inline-formula> and <bold><italic>P</italic></bold><sub>1|0</sub>&#x02009;=&#x02009;<bold><italic>P</italic></bold><sub>0</sub> and linearizations<disp-formula id="Equk"><alternatives><tex-math id="M49">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l}{\boldsymbol{A}}_t=\frac{\partial \boldsymbol{f}}{\partial {\boldsymbol{x}}_t}\Big|{}_{{\boldsymbol{x}}_t={\widehat{\boldsymbol{x}}}_{t|k}}\kern1em \\ {}{\boldsymbol{C}}_k=\frac{\partial \boldsymbol{h}}{\partial {\boldsymbol{x}}_t}\Big|{}_{{\boldsymbol{x}}_t={\widehat{\boldsymbol{x}}}_{k|k-1}},\kern1em \end{array} $$\end{document}</tex-math><mml:math id="M50" display="block"><mml:mtable columnalign="left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo maxsize="1.3em" minsize="1.3em">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:mi mathvariant="bold-italic">h</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">&#x02202;</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo maxsize="1.3em" minsize="1.3em">|</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12248_2015_9718_Article_Equk.gif" position="anchor"/></alternatives></disp-formula>the state variables and their covariance are predicted between two consecutive measurement time points according to<disp-formula id="Equl"><alternatives><tex-math id="M51">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l}\frac{d{\widehat{\boldsymbol{x}}}_{t|k}}{dt}=\boldsymbol{f}\left({\widehat{\boldsymbol{x}}}_{t|k},{\boldsymbol{u}}_t,t,\boldsymbol{\phi} \right),t\in \left[{t}_k,{t}_{k+1}\right]\kern1em \\ {}\frac{d{\boldsymbol{P}}_{t|k}}{dt}={\boldsymbol{A}}_t{\boldsymbol{P}}_{t|k}+{\boldsymbol{P}}_{t|k}{\boldsymbol{A}}_t+\boldsymbol{\Sigma} {\boldsymbol{\Sigma}}^T,t\in \left[{t}_k,{t}_{k+1}\right].\kern1em \end{array} $$\end{document}</tex-math><mml:math id="M52" display="block"><mml:mtable columnalign="left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">A</mml:mi></mml:mrow><mml:mi>t</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi mathvariant="bold">&#x003a3;</mml:mi><mml:msup><mml:mrow><mml:mi mathvariant="bold">&#x003a3;</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>&#x02208;</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12248_2015_9718_Article_Equl.gif" position="anchor"/></alternatives></disp-formula></p><p>From the predicted state variables and their covariance, we have the output prediction equations<disp-formula id="Equm"><alternatives><tex-math id="M53">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l}{\widehat{\boldsymbol{y}}}_{k|k-1}=\boldsymbol{h}\left({\widehat{\boldsymbol{x}}}_{k|k-1},{\boldsymbol{u}}_k,{t}_k,\boldsymbol{\phi} \right)\kern1em \\ {}{\boldsymbol{R}}_{k|k-1}={\boldsymbol{C}}_k{\boldsymbol{P}}_{k|k-1}{\boldsymbol{C}}_k^T+\boldsymbol{S}.\kern1em \end{array} $$\end{document}</tex-math><mml:math id="M54" display="block"><mml:mtable columnalign="left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi mathvariant="bold-italic">h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>t</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">&#x003d5;</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi mathvariant="bold-italic">S</mml:mi><mml:mo>.</mml:mo><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12248_2015_9718_Article_Equm.gif" position="anchor"/></alternatives></disp-formula></p><p>From the state covariance <bold><italic>P</italic></bold><sub><italic>k</italic>|<italic>k</italic>&#x02009;&#x02212;&#x02009;1</sub> and measurement covariance <bold><italic>R</italic></bold><sub><italic>k</italic>|<italic>k</italic>&#x02009;&#x02212;&#x02009;1</sub>, the Kalman gain is given by<disp-formula id="Equn"><alternatives><tex-math id="M55">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{K}}_k={\boldsymbol{P}}_{k|k-1}{\boldsymbol{C}}_k^T{\boldsymbol{R}}_{k|k-1}^{-1}. $$\end{document}</tex-math><mml:math id="M56" display="block"><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">C</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Equn.gif" position="anchor"/></alternatives></disp-formula></p><p>Finally, the state and its covariance are updated according to<disp-formula id="Equo"><alternatives><tex-math id="M57">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l}{\widehat{\boldsymbol{x}}}_{k|k}={\widehat{\boldsymbol{x}}}_{k|k-1}+{\boldsymbol{K}}_k{\boldsymbol{\epsilon}}_k\kern1em \\ {}{\boldsymbol{P}}_{k|k}={\boldsymbol{P}}_{k|k-1}-{\boldsymbol{K}}_k{\boldsymbol{R}}_{k|k-1}{\boldsymbol{K}}_k^T,\kern1em \end{array} $$\end{document}</tex-math><mml:math id="M58" display="block"><mml:mtable columnalign="left" columnspacing="1em" rowspacing="4pt"><mml:mtr><mml:mtd><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow/><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">P</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">R</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">K</mml:mi></mml:mrow><mml:mi>k</mml:mi><mml:mi>T</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mrow><mml:mspace width=".5em"/><mml:mspace width=".5em"/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12248_2015_9718_Article_Equo.gif" position="anchor"/></alternatives></disp-formula>where the residual <bold><italic>&#x003f5;</italic></bold><sub><italic>k</italic></sub> is given by<disp-formula id="Equp"><alternatives><tex-math id="M59">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {\boldsymbol{\epsilon}}_k={\boldsymbol{y}}_k-{\widehat{\boldsymbol{y}}}_{k|k-1}. $$\end{document}</tex-math><mml:math id="M60" display="block"><mml:msub><mml:mi mathvariant="bold-italic">&#x003f5;</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow><mml:mi>k</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math><graphic xlink:href="12248_2015_9718_Article_Equp.gif" position="anchor"/></alternatives></disp-formula></p></sec><sec id="Sec7"><title>Optimization of the Approximate Population Likelihood</title><p>To maximize the approximate population likelihood in Eq. (<xref rid="Equ9" ref-type="">10</xref>), we have to solve a nested optimization problem. For every value of the population parameters <bold><italic>&#x003b8;</italic></bold> in the optimization of the approximate population likelihood, the individual likelihoods in Eq. (<xref rid="Equ7" ref-type="">7</xref>) have to be maximized with respect to the random effects due to the Laplace approximation. We refer to the maximization of the individual likelihoods as the inner optimization problem and maximization of the approximate population likelihood as the outer optimization problem.</p><p>For the outer and inner optimization problems, we use a local gradient-based quasi-Newton optimization routine based on the Broyden-Fletcher-Goldfarb-Shannon (BFGS) updating formula (<xref ref-type="bibr" rid="CR35">35</xref>). The BFGS updating formula is a popular optimization method because it performs well in many different problems.</p><p>Since the optimization methods are gradient-based, we need to calculate the gradient of the outer objective function (10) and the gradient of the inner objective function (7). We also need to calculate the approximate Hessians (8) or (9) of the inner objective function. As argued in (<xref ref-type="bibr" rid="CR28">28</xref>), there are three approaches to this problem, namely (i) approximations based on finite differences, (ii) symbolic differentiation, or (iii) automatic differentiation tools. Instead of using finite difference approximation, as performed in (<xref ref-type="bibr" rid="CR8">8</xref>, <xref ref-type="bibr" rid="CR10">10</xref>), we use symbolic differentiation using the symbolic algebra capability in Mathematica. By using symbolic derivation, the system of ODEs if differentiated with respect to the model parameters to obtain the so-called sensitivity equations. These sensitivity equations are integrated together with the original system of ODEs to form the expression of the gradient.<list list-type="bullet"><list-item><p>Application 1: Simulation and estimation of a stochastic one-compartmental pharmacokinetic model</p></list-item></list></p><p>To illustrate the concept of SDEs explained in the previous section, we consider a one-compartment pharmacokinetic model with first-order input and nonlinear elimination. In this application, we validate the proposed stochastic modeling framework. A necessary condition is that the model parameters and the three sources of variability (measurement error, population variability, and model uncertainty) can be identified. Here, we consider data from a simulated population consisting of 20 animals. Moreover, we are interested in investigating the difference in parameter estimates with an assumption of a deterministic model. Consider the deterministic mixed effects pharmacokinetic model<disp-formula id="Equq"><alternatives><tex-math id="M61">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{ll}\frac{d{A}_i}{dt}=-{k}_{ai}{A}_i,\hfill &#x00026; {A}_i(0)=20\hfill \\ {}V\frac{d{C}_i}{dt}={k}_{ai}{A}_i-\frac{V_{mi}}{K_m+{C}_i}{C}_i,\hfill &#x00026; {C}_i(0)=0,\hfill \end{array} $$\end{document}</tex-math><mml:math id="M62"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">ai</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mi>V</mml:mi><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">ai</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext>,</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12248_2015_9718_Article_Equq.gif" position="anchor"/></alternatives></disp-formula>where <italic>A</italic><sub><italic>i</italic></sub> (mg) and <italic>C</italic><sub><italic>i</italic></sub> (mg L<sup>&#x02212;1</sup>) are the amount of drug in the GI tract and the concentration of drug in plasma for individual <italic>i</italic>, respectively. We assume that the <italic>k</italic><sub><italic>ai</italic></sub> and <italic>V</italic><sub><italic>mi</italic></sub> are multivariate log-normal distributed, that is<disp-formula id="Equr"><alternatives><tex-math id="M63">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{l}{k}_{ai}={k}_a \exp \left({\eta}_{i1}\right),\hfill \\ {}{V}_{mi}={V}_m \exp \left({\eta}_{i2}\right),\hfill \end{array} $$\end{document}</tex-math><mml:math id="M64"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">ai</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mfenced><mml:mtext>,</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12248_2015_9718_Article_Equr.gif" position="anchor"/></alternatives></disp-formula>where the random effects vector <bold><italic>&#x003b7;</italic></bold>&#x02009;=&#x02009;(<italic>&#x003b7;</italic><sub><italic>i</italic>1</sub>,&#x02009;<italic>&#x003b7;</italic><sub><italic>i</italic>2</sub>) is assumed to follow a multivariate normal distribution with mean zero and covariance matrix <bold>&#x003a9;</bold>. The parameters of the model are the <italic>k</italic><sub><italic>a</italic></sub> (min<sup>&#x02212;1</sup>), <italic>V</italic><sub><italic>m</italic></sub> (mg min<sup>&#x02212;1</sup>), <italic>K</italic><sub><italic>m</italic></sub> (mg L<sup>&#x02212;1</sup>), and <italic>V</italic> (L). Moreover, we parameterize <bold>&#x003a9;</bold>&#x02009;=&#x02009;<bold><italic>UU</italic></bold><sup><italic>T</italic></sup>, where <bold><italic>U</italic></bold> is an upper triangular matrix of the form<disp-formula id="Equs"><alternatives><tex-math id="M65">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \boldsymbol{U} = \left(\begin{array}{cc}\hfill {\omega}_{11}\hfill &#x00026; \hfill {\omega}_{12}\hfill \\ {}\hfill 0\hfill &#x00026; \hfill {\omega}_{22}\hfill \end{array}\right). $$\end{document}</tex-math><mml:math id="M66"><mml:mi mathvariant="bold-italic">U</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mn>11</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mn>12</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12248_2015_9718_Article_Equs.gif" position="anchor"/></alternatives></disp-formula></p><p>The reason for the parameterization <bold>&#x003a9;</bold>&#x02009;=&#x02009;<bold><italic>UU</italic></bold><sup><italic>T</italic></sup> is to assure that <bold>&#x003a9;</bold> is a positive definite matrix, a necessary condition since it is a covariance matrix. We get<disp-formula id="Equt"><alternatives><tex-math id="M67">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \boldsymbol{\Omega} = \left(\begin{array}{cc}\hfill {\omega}_{11}^2+{\omega}_{12}^2\hfill &#x00026; \hfill {\omega}_{12}{\omega}_{22}\hfill \\ {}\hfill {\omega}_{12}{\omega}_{22}\hfill &#x00026; \hfill {\omega}_{22}^2\hfill \end{array}\right). $$\end{document}</tex-math><mml:math id="M68"><mml:mi mathvariant="bold">&#x003a9;</mml:mi><mml:mo>=</mml:mo><mml:mspace width="0.25em"/><mml:mfenced close=")" open="("><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:msubsup><mml:mi>&#x003c9;</mml:mi><mml:mn>11</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mo>+</mml:mo><mml:msubsup><mml:mi>&#x003c9;</mml:mi><mml:mn>12</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mn>12</mml:mn></mml:msub><mml:msub><mml:mi>&#x003c9;</mml:mi><mml:mn>22</mml:mn></mml:msub></mml:mtd><mml:mtd columnalign="center"><mml:msubsup><mml:mi>&#x003c9;</mml:mi><mml:mn>22</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:mfenced><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12248_2015_9718_Article_Equt.gif" position="anchor"/></alternatives></disp-formula></p><p>Using additive system noise, we end up with an SDE describing the concentration of drug.<disp-formula id="Equ10"><label>11</label><alternatives><tex-math id="M69">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ Vd{C}_i=\left({k}_{ai}{A}_i-\frac{V_{mi}}{K_m+{C}_i}{C}_i\right)dt+\sigma d{W}_i,\ {C}_i(0)=0. $$\end{document}</tex-math><mml:math id="M70"><mml:mi>V</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">ai</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext>.</mml:mtext></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ10.gif" position="anchor"/></alternatives></disp-formula></p><p>In the stochastic model, there exists a system noise <italic>&#x003c3;d</italic><bold><italic>W</italic></bold><sub><italic>i</italic></sub>, where <italic>&#x003c3;</italic> is the scaling factor and <italic>d</italic><bold><italic>W</italic></bold><sub><italic>i</italic></sub> is the increment of a standard Wiener process. In Eq. (<xref rid="Equ10" ref-type="">11</xref>), the system noise is independent of the drug concentration. This may not be a realistic assumption since it allows for a change in concentration even in the absence of drug. By defining the system noise dependent on the concentration level itself, such phenomena can be avoided. The final model, which we consider for simulation and estimation, is<disp-formula id="Equ11"><label>12</label><alternatives><tex-math id="M71">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{cc}\hfill \frac{d{A}_i}{dt} = -{k}_{ai}{A}_i,\hfill &#x00026; \hfill {A}_i(0)=20\hfill \end{array} $$\end{document}</tex-math><mml:math id="M72"><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mspace width="0.25em"/><mml:mo>=</mml:mo><mml:mo>&#x02212;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">ai</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mn>20</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ11.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ12"><label>13</label><alternatives><tex-math id="M73">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \begin{array}{cc}\hfill Vd{C}_i=\left({k}_{ai}{A}_i-\frac{V_{mi}}{K_m+{C}_i}{C}_i\right)dt+\sigma {\hat{C}}_id{W}_i,\hfill &#x00026; \hfill {C}_i(0)=0,\hfill \end{array} $$\end{document}</tex-math><mml:math id="M74"><mml:mtable columnalign="center"><mml:mtr columnalign="center"><mml:mtd columnalign="center"><mml:mi>V</mml:mi><mml:mi>d</mml:mi><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mi mathvariant="italic">ai</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mfrac><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:msub><mml:mi>&#x00108;</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mtd><mml:mtd columnalign="center"><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mtext>,</mml:mtext></mml:mtd></mml:mtr></mml:mtable></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ12.gif" position="anchor"/></alternatives></disp-formula>where <italic>&#x003c3;</italic> (L min<sup>&#x02212;1</sup>) is the system noise factor. In the SDE above, <italic>&#x00108;</italic><sub><italic>i</italic></sub> denotes the approximation of the conditional expectation of the concentration <italic>C</italic><sub><italic>i</italic></sub> computed by the EKF. The reason for this model is that the EKF does not allow for state-dependent system noise. However, by utilizing the approximation of the conditional expectation of the concentration, we can still use a proportional-like system noise. For SDEs with system noise dependent on the stochastic process itself, one can in rare cases use the Lamperti transform to obtain a state-independent system noise. The SDE (12)&#x02013;(13) has a stochastic part in the equation describing the central compartment. Since <italic>dW</italic><sub><italic>i</italic></sub> is the increment of a Wiener process, this implies that <italic>dW</italic><sub><italic>i</italic></sub> is normally distributed with variance <italic>dt</italic>, which in turn implies that <italic>&#x003c3;&#x00108;</italic><sub><italic>i</italic></sub><italic>dW</italic><sub><italic>i</italic></sub> is normally distributed with variance <italic>&#x003c3;</italic><sup>2</sup><italic>&#x00108;</italic><sub arrange="stack"><italic>i</italic></sub><sup arrange="stack">2</sup><italic>dt</italic>.</p><p>Mass-balance constrains for SDE models can be enforced by assign the structure of <bold>&#x003a3;</bold> according to the stoichiometry of the modeled system. For example, accounting for uncertainty in the drug uptake rate from the GI tract can be achieved by adding the same system noise term to the Eq. (<xref rid="Equ11" ref-type="">12</xref>) with opposite sign. However, we have chosen to assume that the system noise describes an uncertainty in the elimination process from the central compartment, requiring no mass-balancing.</p><p>Furthermore, the measurement <italic>y</italic><sub><italic>ik</italic></sub> is the concentration for individual <italic>i</italic> measured at time <italic>t</italic><sub><italic>ik</italic></sub> under additive Gaussian noise according to<disp-formula id="Equ13"><label>14</label><alternatives><tex-math id="M75">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {y}_{ik}={C}_i\left({t}_{ik}\right)+{e}_{ik}, $$\end{document}</tex-math><mml:math id="M76"><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mfenced><mml:mo>+</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ13.gif" position="anchor"/></alternatives></disp-formula>where <italic>e</italic><sub><italic>ik</italic></sub>&#x02009;~&#x02009;<italic>N</italic>(0,&#x02009;<italic>s</italic><sup>2</sup>). A population consisting of 20 animals is simulated according to the parameter values in the third column of Table <xref rid="Tab1" ref-type="table">I</xref>. A total of 100 data sets are simulated, and the model parameters are estimated using the FOCEI method. The response is measured at equidistant time points <italic>t</italic><sub><italic>k</italic></sub>&#x02009;=&#x02009;1, 9, 17, &#x02026;, 97 minutes for all animals.<table-wrap id="Tab1"><label>Table I</label><caption><p>Estimated parameter values for the one-compartmental model (12)&#x02013;(13) using the ODE and the SDE model</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Definition</th><th>True value</th><th>Starting value</th><th>ODE model (RSE %)</th><th>SDE model (RSE %)</th></tr></thead><tbody><tr><td>
<italic>k</italic>
<sub><italic>a</italic></sub>
</td><td>First-order absorption</td><td char="." align="char">0.1</td><td char="." align="char">0.2</td><td>0.078 (22.6)</td><td>0.103 (12.9)</td></tr><tr><td>
<italic>V</italic>
<sub><italic>m</italic></sub>
</td><td>Maximal velocity</td><td char="." align="char">0.5</td><td char="." align="char">1</td><td>0.637 (20.3)</td><td>0.508 (9.52)</td></tr><tr><td>
<italic>K</italic>
<sub><italic>m</italic></sub>
</td><td>Michaelis-Menten const.</td><td char="." align="char">3</td><td char="." align="char">1</td><td>5.43 (51.3)</td><td>3.04 (14.9)</td></tr><tr><td>
<italic>V</italic>
</td><td>Compartmental volume</td><td char="." align="char">1</td><td char="." align="char">2</td><td>0.793 (17.6)</td><td>1.00 (5.50)</td></tr><tr><td>
<italic>s</italic>
</td><td>Measurement error std.</td><td char="." align="char">0.1</td><td char="." align="char">0.5</td><td>0.609 (17.2)</td><td>0.099 (7.49)</td></tr><tr><td>
<italic>&#x003c9;</italic>
<sub>11</sub>
</td><td>Interindividual variability <italic>k</italic>
<sub><italic>a</italic></sub>
</td><td char="." align="char">0.5</td><td char="." align="char">0.1</td><td>0.403 (22.8)</td><td>0.456 (18.4)</td></tr><tr><td>
<italic>&#x003c9;</italic>
<sub>12</sub>
</td><td>Interindividual correlation</td><td char="." align="char">0.1</td><td char="." align="char">0</td><td>0.098 (120.9)</td><td>0.092 (149.5)</td></tr><tr><td>
<italic>&#x003c9;</italic>
<sub>22</sub>
</td><td>Interindividual variability <italic>V</italic>
<sub><italic>m</italic></sub>
</td><td char="." align="char">0.3</td><td char="." align="char">0.1</td><td>0.332 (18.3)</td><td>0.279 (18.9)</td></tr><tr><td>
<italic>&#x003c3;</italic>
</td><td>System noise factor</td><td char="." align="char">0.05</td><td char="." align="char">0.01</td><td>-</td><td>0.050 (6.56)</td></tr></tbody></table><table-wrap-foot><p>The relative standard errors (RSEs) in % are included in parenthesis</p></table-wrap-foot></table-wrap><list list-type="bullet"><list-item><p>Application 2: Stochastic NiAc disposition in obese Zucker rats</p></list-item></list></p><p>In this section, we extend a pharmacokinetic model of nicotinic acid (NiAc) in obese Zucker rats, previously used to drive a pharmacodynamic model describing nonesterified fatty acid (NEFA) turnover (<xref ref-type="bibr" rid="CR36">36</xref>&#x02013;<xref ref-type="bibr" rid="CR41">41</xref>). The disposition of NiAc in obese rats was described by a one-compartment model with endogenous synthesis of NiAc and a capacity-limited elimination process. Instead of using a deterministic model for the pharmacokinetics, we consider the extension to a stochastic NiAc disposition model.</p></sec><sec id="Sec8"><title>Original NiAc Disposition Model</title><p>The previously used pharmacokinetic model was a one-compartmental model with a synthesis rate <italic>Synt</italic> (<inline-formula id="IEq6"><alternatives><tex-math id="M77">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M78"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq6.gif"/></alternatives></inline-formula>mol min<sup>&#x02212;1</sup> kg<sup>&#x02212;1</sup>) of NiAc in the absence of drug with a nonlinear elimination with parameters <italic>V</italic><sub><italic>mi</italic></sub> (<inline-formula id="IEq7"><alternatives><tex-math id="M79">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M80"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq7.gif"/></alternatives></inline-formula>mol min<sup>&#x02212;1</sup> kg<sup>&#x02212;1</sup>) and <italic>K</italic><sub><italic>m</italic></sub> (<inline-formula id="IEq8"><alternatives><tex-math id="M81">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M82"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq8.gif"/></alternatives></inline-formula>mol L<sup>&#x02212;1</sup>) describing the maximal rate from the central compartment and the Michaelis-Menten constant, respectively. The mixed effects kinetics is described by the ODE<disp-formula id="Equ14"><label>15</label><alternatives><tex-math id="M83">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {V}_c\frac{d{c}_i}{dt}=u+ Synt-\frac{V_{mi}{c}_i}{K_m+{c}_i}, $$\end{document}</tex-math><mml:math id="M84"><mml:msub><mml:mi>V</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">Synt</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ14.gif" position="anchor"/></alternatives></disp-formula><disp-formula id="Equ15"><label>16</label><alternatives><tex-math id="M85">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {c}_i(0)=\frac{Synt\ {K}_m}{V_{mi}- Synt}, $$\end{document}</tex-math><mml:math id="M86"><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mfenced close=")" open="("><mml:mn>0</mml:mn></mml:mfenced><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="italic">Synt</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>&#x02212;</mml:mo><mml:mi mathvariant="italic">Synt</mml:mi></mml:mrow></mml:mfrac><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ15.gif" position="anchor"/></alternatives></disp-formula></p><p>where <italic>u</italic> (<inline-formula id="IEq9"><alternatives><tex-math id="M87">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M88"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq9.gif"/></alternatives></inline-formula>mol min<sup>&#x02212;1</sup> kg<sup>&#x02212;1</sup>) denotes the input. Two different infusion rates were used, 0.67&#x02009;<inline-formula id="IEq10"><alternatives><tex-math id="M89">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M90"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq10.gif"/></alternatives></inline-formula>mol min<sup>&#x02212;1</sup> kg<sup>&#x02212;1</sup> (corresponding to 20&#x02009;<inline-formula id="IEq11"><alternatives><tex-math id="M91">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M92"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq11.gif"/></alternatives></inline-formula>mol kg<sup>&#x02212;1</sup> over 30 min) and 0.17&#x02009;<inline-formula id="IEq12"><alternatives><tex-math id="M93">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M94"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq12.gif"/></alternatives></inline-formula>mol min<sup>&#x02212;1</sup> kg<sup>&#x02212;1</sup> (corresponding to 51&#x02009;<inline-formula id="IEq13"><alternatives><tex-math id="M95">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M96"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq13.gif"/></alternatives></inline-formula>mol kg<sup>&#x02212;1</sup> over 300 min).</p><p>In previous work, in addition to <italic>V</italic><sub><italic>mi</italic></sub>, <italic>Synt</italic> was allowed to be distributed in the population. In this paper, we only consider <italic>V</italic><sub><italic>mi</italic></sub>, to be distributed in the population. This choice was due to the fact that few data samples were taken at steady-state and that the estimation results in (<xref ref-type="bibr" rid="CR39">39</xref>) showed a very high residual standard error on the interindividual variability parameters. We consider a log-normal distribution of the maximal rate <italic>V</italic><sub><italic>mi</italic></sub>. That is<disp-formula id="Equu"><alternatives><tex-math id="M97">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {V}_{mi}={V}_m \exp \left({\eta}_i\right), $$\end{document}</tex-math><mml:math id="M98"><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>exp</mml:mo><mml:mfenced close=")" open="("><mml:msub><mml:mi>&#x003b7;</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mfenced><mml:mtext>,</mml:mtext></mml:math><graphic xlink:href="12248_2015_9718_Article_Equu.gif" position="anchor"/></alternatives></disp-formula></p><p>where <italic>&#x003b7;</italic><sub><italic>i</italic></sub>&#x02009;~&#x02009;<italic>N</italic>(0,&#x02009;<italic>&#x003c9;</italic><sup>2</sup>). <italic>V</italic><sub><italic>c</italic></sub> (L kg<sup>&#x02212;1</sup>) denotes the central volume. The first group consisted of eight subjects and the second group of seven subjects. There was also one subject receiving placebo, giving a total of 16 subjects in the analysis.</p></sec><sec id="Sec9"><title>Stochastic NiAc Disposition Model</title><p>We consider the extension to a stochastic NiAc model described by the SDE<disp-formula id="Equ16"><label>17</label><alternatives><tex-math id="M99">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ {V}_cd{c}_i=\left(u+ Synt-\frac{V_{mi}{c}_i}{K_m+{c}_i}\right)dt+\sigma {\widehat{c}}_id{W}_i $$\end{document}</tex-math><mml:math id="M100"><mml:msub><mml:mi>V</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfenced close=")" open="("><mml:mrow><mml:mi>u</mml:mi><mml:mo>+</mml:mo><mml:mi mathvariant="italic">Synt</mml:mi><mml:mo>&#x02212;</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfenced><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>&#x003c3;</mml:mi><mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>W</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:math><graphic xlink:href="12248_2015_9718_Article_Equ16.gif" position="anchor"/></alternatives></disp-formula></p><p>In the stochastic NiAc disposition model, the system noise <italic>&#x003c3;&#x00109;</italic><sub><italic>i</italic></sub><italic>dW</italic><sub><italic>i</italic></sub> models the uncertainty in dynamics. Again, we assume a system noise proportional to the mode <italic>&#x00109;</italic><sub><italic>i</italic></sub>. We refer to <italic>&#x003c3;</italic> (L min<sup>&#x02212;1</sup> kg<sup>&#x02212;1</sup>) as the system noise factor. In contrast to the original NiAc disposition model, the total error is now divided into measurement error and system noise. The choice of the stochastic model structure is to allow for an uncertainty in the elimination process dependent on the drug concentration.</p><p>The purpose of the extension is to identify the structural parameters together with the sources of variability. Most importantly, we are interested in identifying the system noise factor <italic>&#x003c3;</italic>. Note that <italic>&#x003c3;</italic>&#x02009;=&#x02009;0 corresponds to the original NiAc disposition model.</p></sec></sec></sec><sec id="Sec10" sec-type="results"><title>RESULTS</title><p><list list-type="bullet"><list-item><p>Application 1: Simulation and estimation of a stochastic one-compartmental pharmacokinetic model</p></list-item></list></p><p>In this example, the primary interest lies in how well the parameters in the model can be estimated from data. Since we have three sources of variability (parameter variability, measurement error, and system noise), it is important to know whether these sources of variability can be separated in the estimation.</p><p>The parameters in the model are estimated using the FOCEI method. The parameters in the model consist of the structural parameters <italic>k</italic><sub><italic>a</italic></sub>, <italic>V</italic><sub><italic>m</italic></sub>, <italic>K</italic><sub><italic>m</italic></sub> and <italic>V</italic> and the parameters <italic>s</italic>, <italic>&#x003c9;</italic><sub>11</sub>,&#x02009;<italic>&#x003c9;</italic><sub>12</sub>, <italic>&#x003c9;</italic><sub>22</sub> and <italic>&#x003c3;</italic> describing the three sources of variability. Hence, our vector of model parameters is <bold><italic>&#x003b8;</italic></bold>&#x02009;=&#x02009;(<italic>k</italic><sub><italic>a</italic></sub>, <italic>V</italic><sub><italic>m</italic></sub>, <italic>K</italic><sub><italic>m</italic></sub>,&#x02009;<italic>V</italic>,&#x02009;<italic>s</italic>, <italic>&#x003c9;</italic><sub>11</sub>,&#x02009;<italic>&#x003c9;</italic><sub>12</sub>, <italic>&#x003c9;</italic><sub>22</sub>,&#x02009;<italic>&#x003c3;</italic>) which gives a total number of 9 parameters to be estimated.</p><p>We estimate the model parameters using the SDE approach and compare this to the corresponding ODE model (<italic>&#x003c3;</italic>&#x02009;=&#x02009;0). The estimated parameter values using the SDE model and the ODE model are shown in Table <xref rid="Tab1" ref-type="table">I</xref>. The relative standard errors (RSEs) in % are included in parentheses. They are obtained by calculating the mean and standard deviations of the 100 estimates. The distribution of the estimated model parameters for the 100 simulated data sets are seen in Fig. <xref rid="Fig1" ref-type="fig">1</xref>.<fig id="Fig1"><label>Fig. 1</label><caption><p>Smoothed histograms over the estimated parameters from 100 simulated data sets. The estimated parameters using the SDE model is shown in <italic>blue</italic> and the estimates using the ODE model (<italic>&#x003c3;</italic>&#x02009;=&#x02009;0) is shown in <italic>purple. The vertical lines</italic> show the parameter values used for simulation</p></caption><graphic xlink:href="12248_2015_9718_Fig1_HTML" id="MO1"/></fig><list list-type="bullet"><list-item><p>Application 2: Stochastic NiAc disposition in obese Zucker rats</p></list-item></list></p><p>The measured NiAc concentrations for the two infusion groups are shown in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.<fig id="Fig2"><label>Fig. 2</label><caption><p>Plots of the estimated ODE (<italic>solid</italic>) and SDE (<italic>dashed</italic>) NiAc model together with the observed concentration time courses of NiAc for the two infusion groups. <bold>a</bold> 20&#x02009;<inline-formula id="IEq14"><alternatives><tex-math id="M101">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M102"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq14.gif"/></alternatives></inline-formula>mol kg<sup>&#x02212;1</sup> over 30 min. <bold>b</bold> 51&#x02009;<inline-formula id="IEq15"><alternatives><tex-math id="M103">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M104"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq15.gif"/></alternatives></inline-formula>mol kg<sup>&#x02212;1</sup> over 300 min over 300 min. The concentration is shown on a log-linear scale</p></caption><graphic xlink:href="12248_2015_9718_Fig2_HTML" id="MO2"/></fig></p><sec id="Sec11"><title>Estimated Parameters</title><p>The parameters are estimated using the FOCE approximation of the individual Hessians. The reason for using the FOCE approximation is to guarantee that the individual Hessians are positive definite. The starting values for the structural parameters were adopted from Ahlstr&#x000f6;m et al. (<xref ref-type="bibr" rid="CR39">39</xref>) with values <italic>V</italic><sub><italic>m</italic></sub>&#x02009;=&#x02009;1.8 <inline-formula id="IEq16"><alternatives><tex-math id="M105">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M106"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq16.gif"/></alternatives></inline-formula>mol min<sup>&#x02212;1</sup> kg<sup>&#x02212;1</sup>, <italic>K</italic><sub><italic>m</italic></sub>&#x02009;=&#x02009;23 <inline-formula id="IEq17"><alternatives><tex-math id="M107">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M108"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq17.gif"/></alternatives></inline-formula>mol L<sup>&#x02212;1</sup>, <italic>V</italic><sub><italic>c</italic></sub>&#x02009;=&#x02009;0.319 L kg<sup>&#x02212;1</sup>, and <italic>Synt</italic>&#x02009;=&#x02009;0.00125 <inline-formula id="IEq18"><alternatives><tex-math id="M109">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M110"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq18.gif"/></alternatives></inline-formula>mol min<sup>&#x02212;1</sup> kg<sup>&#x02212;1</sup>. Moreover, the starting values for the variance components were <italic>s</italic>&#x02009;=&#x02009;0.1, <italic>&#x003c9;</italic>&#x02009;=&#x02009;0.1, and <italic>&#x003c3;</italic>&#x02009;=&#x02009;0.01 L min<sup>&#x02212;1</sup> (for the SDE model).</p><p>Table <xref rid="Tab2" ref-type="table">II</xref> shows the estimated parameters for the two models of interest. As a reference, we also provide the estimates from Ahlstr&#x000f6;m <italic>et al</italic>. (<xref ref-type="bibr" rid="CR39">39</xref>). The relative standard errors (RSEs) in % are included in parentheses, calculated from the approximated Hessian at the optimum. Two comparisons are of interest. First, we used the original NiAc disposition model (15) to compare the results from our estimation with the results from (<xref ref-type="bibr" rid="CR39">39</xref>). Second, we are interested in the differences in parameter estimates using the original NiAc disposition model (15) and the stochastic NiAc disposition model (17).<table-wrap id="Tab2"><label>Table II</label><caption><p>Estimated parameter values and interindividual variability (IIV) for the NiAc disposition model, with corresponding relative standard errors (RSE %)</p></caption><table frame="hsides" rules="groups"><thead><tr><th>Parameter</th><th>Definition</th><th>Ahlstr&#x000f6;m <italic>et al</italic>.</th><th>Current investigation: ODE model</th><th>Current investigation: SDE model</th></tr></thead><tbody><tr><td>
<italic>V</italic>
<sub><italic>m</italic></sub>
</td><td>Maximal velocity</td><td>1.59 (13.9)</td><td>1.46 (16.3)</td><td>1.35 (16.7)</td></tr><tr><td>
<italic>K</italic>
<sub><italic>m</italic></sub>
</td><td>Michaelis-Menten const.</td><td>18.9 (21.5)</td><td>15.2 (21.7)</td><td>13.6 (21.5)</td></tr><tr><td>
<italic>V</italic>
<sub><italic>c</italic></sub>
</td><td>Central volume</td><td>0.328 (12.4)</td><td>0.29 (4.3)</td><td>0.32 (5.5)</td></tr><tr><td>
<italic>Synt</italic>
</td><td>Endogenous synthesis rate</td><td>0.00280 (10.1)</td><td>0.0006 (29.5)</td><td>0.0018 (24.3)</td></tr><tr><td>
<italic>s</italic>
</td><td>Residual prop. error</td><td>0.400 (26.3)</td><td>0.460 (8.08)</td><td>0.241 (11.7)</td></tr><tr><td>
<italic>&#x003c9;</italic>
</td><td>Variability <italic>V</italic>
<sub><italic>m</italic></sub>
</td><td>0.214 (234)</td><td>0.174 (22.5)</td><td>0.133 (27.0)</td></tr><tr><td>
<italic>&#x003c3;</italic>
</td><td>System noise factor</td><td>-</td><td>-</td><td>0.033 (15.7)</td></tr></tbody></table><table-wrap-foot><p>See Ahlstr&#x000f6;m <italic>et al.</italic> (<xref ref-type="bibr" rid="CR39">39</xref>) for reference</p></table-wrap-foot></table-wrap></p></sec><sec id="Sec12"><title>Fitted Population and Individual Models</title><p>The fitted population models for the two approaches are illustrated in Fig. <xref rid="Fig2" ref-type="fig">2</xref>.</p><p>Given the estimated population parameters as priors, the individual likelihoods are maximized once again to obtain the <italic>maximum a posteriori</italic> estimates for the random effect parameters. These optimal parameter values are then inserted in the model equations to obtain the individual model fits. The original NiAc disposition model fit is obtained by simply solving the ODE describing NiAc concentration given an individual&#x02019;s parameter values. For the stochastic NiAc disposition model, the individual fit is slightly more complicated to obtain. Due to the stochastic component, the individual model fits for the stochastic model are obtained by a method called smoothing. This has previously been demonstrated by Kristensen <italic>et al</italic>. (<xref ref-type="bibr" rid="CR2">2</xref>). When smoothing is used, the model is used to provide an optimal state estimator given all the measurements for a specific individual. The fitted individual models together with the output uncertainties are illustrated in Fig. <xref rid="Fig3" ref-type="fig">3</xref> for three animals (rows 1&#x02013;3) with the shorter infusion for the estimated ODE (a&#x02013;c) and SDE (d&#x02013;f) NiAc disposition model. The uncertainty bands represent one standard deviation of the output uncertainty (that is, the square root of the output covariance). Note that the concentration and its uncertainty are visualized on a linear scale, in contrast to the previous plots in Fig. <xref rid="Fig2" ref-type="fig">2</xref>, to emphasize the improved fit for large NiAc concentrations using SDEs.<fig id="Fig3"><label>Fig. 3</label><caption><p>Observed plasma NiAc concentration time profiles together with the estimated ODE (<bold>a&#x02013;c</bold>) and SDE (<bold>d</bold>&#x02013;<bold>f</bold>) NiAc disposition model for three animals (<italic>each row</italic>) from the first infusion group (20&#x02009;<inline-formula id="IEq19"><alternatives><tex-math id="M111">\documentclass[12pt]{minimal}
				\usepackage{amsmath}
				\usepackage{wasysym} 
				\usepackage{amsfonts} 
				\usepackage{amssymb} 
				\usepackage{amsbsy}
				\usepackage{mathrsfs}
				\usepackage{upgreek}
				\setlength{\oddsidemargin}{-69pt}
				\begin{document}$$ \mu $$\end{document}</tex-math><mml:math id="M112"><mml:mi>&#x003bc;</mml:mi></mml:math><inline-graphic xlink:href="12248_2015_9718_Article_IEq19.gif"/></alternatives></inline-formula>mol kg<sup>&#x02212;1</sup> over 30 min)</p></caption><graphic xlink:href="12248_2015_9718_Fig3_HTML" id="MO3"/></fig></p></sec></sec><sec id="Sec13" sec-type="discussion"><title>DISCUSSION</title><p>The extension of NLME models to stochastic differential mixed effect models has been considered to provide a more general model to describe the error between model prediction and observed data. By utilizing the stochastic setting, the total error is divided into measurement noise and model uncertainty. Together with the population variability induced in a mixed effect model, we are able to account for a total of three sources of variability.</p><sec id="Sec14"><title>Maximum Likelihood Estimation</title><p>We have taken the maximum likelihood approach to parameter estimation by combining an approximation of the population likelihood together with an extended Kalman filter for state estimation. In contrast to the estimation method proposed in (<xref ref-type="bibr" rid="CR10">10</xref>, <xref ref-type="bibr" rid="CR23">23</xref>&#x02013;<xref ref-type="bibr" rid="CR25">25</xref>), we have further developed the method by considering interaction between the output covariance and random effects, referred to as the FOCEI method (<xref ref-type="bibr" rid="CR33">33</xref>). The interaction between output covariance and random effects occurs for example in ODE models with a proportional measurement noise and in stochastic models where the output covariance depends on the Kalman update, which in turn depends on the individual response.</p><p>The parameters were estimated using the gradient-based method BFGS (<xref ref-type="bibr" rid="CR35">35</xref>). In many applications, the gradient of the objective function is approximated using finite differences. However, numerical ODE solvers with an adaptive step length are known to introduce quantification errors to the objective function, making it nonsmooth on small scales (<xref ref-type="bibr" rid="CR42">42</xref>). To overcome such problems, we utilized the sensitivity equations when calculating the gradient in the inner and outer optimization problem. The sensitivity equations were obtained by differentiating the system of differential equations and the extended Kalman filter equations with respect to the parameters in the model. This has been previously demonstrated by Leander <italic>et al</italic>. (<xref ref-type="bibr" rid="CR11">11</xref>) in the single individual case, and we are preparing a manuscript that concerns the mixed effects case.</p><p>The extension to SDEs comes with an increased computational burden. Due to the fact that we now consider equations describing the time evolution of both mean and covariance of a stochastic process, a larger system of ODEs has to be solved. The implementation of the numerical machinery for parameter estimation also becomes more challenging and requires advanced numerical techniques such as the EKF. The stochastic mixed effects modeling framework has been implemented in Mathematica 9. An executable version of the code may be received from the authors upon request.<list list-type="bullet"><list-item><p>Application 1: Simulation and estimation in the simulated stochastic one-compartmental pharmacokinetic model</p></list-item></list></p><p>As a first application of stochastic mixed effects modeling, we used a stochastic one-compartmental pharmacokinetic model for a simulation study. The aim was to investigate whether the three sources of variability (measurement error, population variability, and model uncertainty) could be separated using the proposed maximum likelihood estimation.</p><p>From the parameter estimates for the SDE model in Table <xref rid="Tab1" ref-type="table">I</xref> and the smoothed histograms in Fig. <xref rid="Fig1" ref-type="fig">1</xref>, we conclude that all estimated parameter values are close to their true values used for simulation. The measurement error standard deviation <italic>s</italic> and the system noise factor <italic>&#x003c3;</italic> are identical to the true values using the SDE approach. Also, the correlation between the random effects is close to the true value for the SDE model. However, the RSE for the random effect correlation is very high, implying that the correlation is difficult to reliably estimate. This may depend on the fact that only 20 individuals were included in each data set.</p><p>In the ODE case, we conclude that all the structural parameters are biased and differ significantly from the true parameter values used for simulating the data. Comparing the results to the ODE case where the system noise is neglected (<italic>&#x003c3;</italic>&#x02009;=&#x02009;0), we can see that the measurement error standard deviation <italic>s</italic> is increased six-fold. Hence, we conclude that when the system noise is set to zero (equivalent to the ODE case), the measurement error standard deviation is increased to account for that variability, which is not unexpected since we neglect the variability in dynamics. We also conclude that the RSEs for the SDE model are generally lower than the RSEs for the ODE model, although the RSEs for <italic>&#x003c9;</italic><sub>12</sub> and <italic>&#x003c9;</italic><sub>22</sub> are slightly higher in the SDE model.</p><p>Most importantly, we conclude that we can successfully distinguish the three sources of variability, which is a necessary condition of the extended framework to be of practical value.<list list-type="bullet"><list-item><p>Application 2: Stochastic NiAc disposition in obese Zucker rats</p></list-item></list></p><p>Using the original NiAc disposition model, and comparing the results with previous work, we can conclude that most of the parameter values are similar. Our estimated values differ most in <italic>K</italic><sub><italic>m</italic></sub> and <italic>Synt</italic>. Note that the quotients <italic>V</italic><sub><italic>m</italic></sub>/<italic>K</italic><sub><italic>m</italic></sub> are similar in the work by Ahlstr&#x000f6;m <italic>et al</italic>. (<xref ref-type="bibr" rid="CR39">39</xref>) and in the current investigation (0.084 and 0.096, respectively). This may imply that there are problems estimating the parameters <italic>V</italic><sub><italic>m</italic></sub> and <italic>K</italic><sub><italic>m</italic></sub>, whereas the quotient as such is identifiable. One striking difference between our estimation and previous results is that the relative standard error for the parameter describing the interindividual variability (IIV) is significantly lower in our investigation. The IIV for <italic>V</italic><sub><italic>m</italic></sub> was 234% in (<xref ref-type="bibr" rid="CR39">39</xref>), while it is reduced to 22.5% in our investigation. This is most likely because instead of using finite difference approximation of the gradient in the optimization problem, we utilize sensitivity equations, yielding a more robust calculation of the gradient, which also seems to influence the precision of parameter estimates.</p><p>If we turn to our investigation and compare the ODE and the SDE NiAc disposition models, we can see that the endogenous synthesis rate <italic>Synt</italic> is increased for the stochastic model, which is also seen in the population model fits in Fig. <xref rid="Fig2" ref-type="fig">2</xref>. Moreover, another difference in the parameter estimates is that the measurement error is much lower (two-fold) for the stochastic model whereas the system noise factor significantly differed from zero. This implies that the error that existed in the original model (measurement error) is now separated into two parts, namely the measurement error and the system noise. The interindividual variability for the maximal rate <italic>V</italic><sub><italic>m</italic></sub> is slightly decreased when the stochastic NiAc disposition model is used. Hence, some of the population variability in the maximal rate <italic>V</italic><sub><italic>m</italic></sub> seen in the original NiAc disposition model may instead be explained by a model uncertainty.</p><p>With respect to the individual fits in Fig. <xref rid="Fig3" ref-type="fig">3</xref>, there is a clear difference in terms of model fits. The original NiAc disposition model, proposed in (<xref ref-type="bibr" rid="CR39">39</xref>), seems to underestimate the drug concentration during the infusion. The stochastic model that we propose is much closer to the measurements and seems to account for model deviation that the original model is not capable of. In the original NiAc disposition model, the output covariance is equal to the measurement covariance, whereas in the stochastic model, it is a combination of the state covariance and measurement covariance.</p><p>That means that the confidence band in the original model simply arises from the variance of measurements, which we assumed to be proportional to the concentration level. Using the stochastic model, we conclude that the uncertainty is highest between two consecutive time points. In contrast to the original model, we have a decreased uncertainty at the measurements, at which information is gained about the underlying system.</p><p>In previous work (<xref ref-type="bibr" rid="CR39">39</xref>), the original NiAc disposition model was used to drive a pharmacodynamic model describing production of NEFA. By utilizing the stochastic NiAc disposition model, the fitted individual models seem to be able to capture the high concentrations during the infusion.</p><p>This is seen in Fig. <xref rid="Fig3" ref-type="fig">3</xref> and may give a better input to the NEFA model. A better input to a pharmacodynamic model can be of broader interest in PKPD modeling, since a deterministic pharmacokinetic model often is used to drive a pharmacodynamic model. Using a stochastic pharmacokinetic model can better account for uncertainty in the drug kinetics.</p></sec></sec><sec id="Sec15" sec-type="conclusion"><title>CONCLUSIONS</title><p>We conclude that the stochastic modeling framework we proposed here leads to a more general framework for handling measurement error and model errors. This framework, together with an effective method for calculating the gradients in the nested optimization problem, provides us with a flexible, robust modeling framework for mixed effects models.</p></sec></body><back><ack><p>This project has partly been supported by the Swedish Foundation for Strategic Research, which is gratefully acknowledged.</p></ack><ref-list id="Bib1"><title>REFERENCES</title><ref id="CR1"><label>1.</label><mixed-citation publication-type="other">Gabrielsson J, Weiner D. Pharmacokinetic and pharmacodynamic data analysis: concepts and applications. 4th ed. Swedish Pharmaceutical Press; 2006.</mixed-citation></ref><ref id="CR2"><label>2.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kristensen</surname><given-names>NR</given-names></name><name><surname>Madsen</surname><given-names>H</given-names></name><name><surname>Ingwersen</surname><given-names>SH</given-names></name></person-group><article-title>Using stochastic differential equations for PK/PD model development</article-title><source>J Pharmacokinet Pharmacodyn</source><year>2005</year><volume>32</volume><issue>1</issue><fpage>109</fpage><lpage>141</lpage><pub-id pub-id-type="pmid">16215845</pub-id></element-citation></ref><ref id="CR3"><label>3.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheiner</surname><given-names>L</given-names></name><name><surname>Beal</surname><given-names>S</given-names></name></person-group><article-title>Evaluation of methods for estimating population pharmacokinetic parameters. I. Michaelis-Menten model: Routine clinical pharmacokinetic data</article-title><source>J Pharmacokinet Biopharm</source><year>1980</year><volume>8</volume><issue>6</issue><fpage>553</fpage><lpage>571</lpage><pub-id pub-id-type="pmid">7229908</pub-id></element-citation></ref><ref id="CR4"><label>4.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Sheiner</surname><given-names>L</given-names></name><name><surname>Beal</surname><given-names>S</given-names></name></person-group><article-title>Evaluation of methods for estimating population pharmacokinetic parameters. III. Monoexponential model: Routine clinical pharmacokinetic data</article-title><source>J Pharmacokinet Biopharm</source><year>1983</year><volume>11</volume><issue>3</issue><fpage>303</fpage><lpage>319</lpage><pub-id pub-id-type="pmid">6644555</pub-id></element-citation></ref><ref id="CR5"><label>5.</label><mixed-citation publication-type="other">Sheiner L, Rosenberg B, Marathe V. Estimation of population characteristics of pharmacokinetic parameters from routine clinical data. J Pharmacokinet Biopharm. 977;5(5):445&#x02013;479.</mixed-citation></ref><ref id="CR6"><label>6.</label><mixed-citation publication-type="other">Davidian M, Giltinan DJ. Nonlinear models for repeated measurement data. 1<sup>st</sup> ed. Chapman &#x00026; Hall; 1995.</mixed-citation></ref><ref id="CR7"><label>7.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Lindstrom</surname><given-names>MJ</given-names></name><name><surname>Bates</surname><given-names>DM</given-names></name></person-group><article-title>Nonlinear mixed effects models for repeated measures data</article-title><source>Biometrics</source><year>1990</year><volume>46</volume><issue>3</issue><fpage>673</fpage><lpage>687</lpage><pub-id pub-id-type="pmid">2242409</pub-id></element-citation></ref><ref id="CR8"><label>8.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Berglund</surname><given-names>M</given-names></name><name><surname>Sunn&#x000e5;ker</surname><given-names>M</given-names></name><name><surname>Adiels</surname><given-names>M</given-names></name><name><surname>Jirstrand</surname><given-names>M</given-names></name><name><surname>Wennberg</surname><given-names>B</given-names></name></person-group><article-title>Investigations of a compartmental model for leucine kinetics using non-linear mixed effects models with ordinary and stochastic differential equations</article-title><source>Math Med Biol</source><year>2012</year><volume>29</volume><issue>4</issue><fpage>361</fpage><lpage>384</lpage><pub-id pub-id-type="pmid">21965323</pub-id></element-citation></ref><ref id="CR9"><label>9.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donnet</surname><given-names>S</given-names></name><name><surname>Foulley</surname><given-names>JL</given-names></name><name><surname>Samson</surname><given-names>A</given-names></name></person-group><article-title>Bayesian analysis of growth curves using mixed effects models defined by stochastic differential equations</article-title><source>Biometrics</source><year>2010</year><volume>66</volume><issue>3</issue><fpage>733</fpage><lpage>741</lpage><pub-id pub-id-type="pmid">19912169</pub-id></element-citation></ref><ref id="CR10"><label>10.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Overgaard</surname><given-names>R</given-names></name><name><surname>Jonsson</surname><given-names>N</given-names></name><name><surname>Torn&#x000f8;e</surname><given-names>C</given-names></name><name><surname>Madsen</surname><given-names>H</given-names></name></person-group><article-title>Non-linear mixed-effects models with stochastic differential equations: implementation of an estimation algorithm</article-title><source>J Pharmacokinet Pharmacodyn</source><year>2005</year><volume>32</volume><issue>1</issue><fpage>85</fpage><lpage>107</lpage><pub-id pub-id-type="pmid">16175312</pub-id></element-citation></ref><ref id="CR11"><label>11.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Leander</surname><given-names>J</given-names></name><name><surname>Lundh</surname><given-names>T</given-names></name><name><surname>Jirstrand</surname><given-names>M</given-names></name></person-group><article-title>Stochastic differential equations as a tool to regularize the parameter estimation problem for continuous time dynamical systems given discrete time measurements</article-title><source>Math Biosci</source><year>2014</year><volume>251</volume><fpage>54</fpage><lpage>62</lpage><pub-id pub-id-type="pmid">24631177</pub-id></element-citation></ref><ref id="CR12"><label>12.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramanathan</surname><given-names>M</given-names></name></person-group><article-title>An application of Ito&#x02019;s lemma in population pharmacokinetics and pharmacodynamics</article-title><source>Pharm Res</source><year>1999</year><volume>16</volume><issue>4</issue><fpage>584</fpage><lpage>586</lpage><pub-id pub-id-type="pmid">10227716</pub-id></element-citation></ref><ref id="CR13"><label>13.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ramanathan</surname><given-names>M</given-names></name></person-group><article-title>A method for estimating pharmacokinetic risks of concentration-dependent drug interactions from preclinical data</article-title><source>Drug Metab Dispos</source><year>1999</year><volume>27</volume><issue>12</issue><fpage>1479</fpage><lpage>1487</lpage><pub-id pub-id-type="pmid">10570030</pub-id></element-citation></ref><ref id="CR14"><label>14.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Gillespie</surname><given-names>DT</given-names></name></person-group><article-title>A general method for numerically stimulating the stochastic time evolution of coupled chemical reactions</article-title><source>J Comput Phys</source><year>1976</year><volume>22</volume><fpage>403</fpage><lpage>434</lpage></element-citation></ref><ref id="CR15"><label>15.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Qi</surname><given-names>X</given-names></name></person-group><article-title>A stochastic version of corticosteriod pharmacogenomic model</article-title><source>AAPS J</source><year>2005</year><volume>7</volume><issue>1</issue><fpage>E134</fpage><lpage>E140</lpage><pub-id pub-id-type="pmid">16146334</pub-id></element-citation></ref><ref id="CR16"><label>16.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Siegel</surname><given-names>RA</given-names></name><name><surname>Ramanathan</surname><given-names>M</given-names></name></person-group><article-title>Commentary: stochastic phenomena in pharmacokinetic, pharmacodynamic, and pharmacogenomic models</article-title><source>AAPS J</source><year>2005</year><volume>7</volume><issue>1</issue><fpage>E141</fpage><lpage>E142</lpage><pub-id pub-id-type="pmid">16493838</pub-id></element-citation></ref><ref id="CR17"><label>17.</label><mixed-citation publication-type="other">Klebaner FC. Introduction to stochastic calculus with applications. Imperial College Press; 2005.</mixed-citation></ref><ref id="CR18"><label>18.</label><mixed-citation publication-type="other">&#x000d8;ksendal B. Stochastic differential equations. An Introduction with Applications. 6<sup>th</sup> ed. Springer; 2003.</mixed-citation></ref><ref id="CR19"><label>19.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Black</surname><given-names>F</given-names></name><name><surname>Scholes</surname><given-names>M</given-names></name></person-group><article-title>The pricing of options and corporate liabilities</article-title><source>J Polit Econ</source><year>1973</year><volume>81</volume><issue>3</issue><fpage>637</fpage><lpage>654</lpage></element-citation></ref><ref id="CR20"><label>20.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Plan</surname><given-names>E</given-names></name><name><surname>Maloney</surname><given-names>A</given-names></name><name><surname>Mentr&#x000e9;</surname><given-names>F</given-names></name><name><surname>Karlsson</surname><given-names>MO</given-names></name><name><surname>Bertrand</surname><given-names>J</given-names></name></person-group><article-title>Performance comparison of various maximum likelihood nonlinear mixed-effects estimation methods for dose-response models</article-title><source>AAPS J</source><year>2012</year><volume>14</volume><issue>3</issue><fpage>420</fpage><lpage>432</lpage><pub-id pub-id-type="pmid">22528503</pub-id></element-citation></ref><ref id="CR21"><label>21.</label><mixed-citation publication-type="other">Pinheiro JC, Bates DM. Mixed-effects models in S and S-PLUS (Statistics and Computing). Springer; 2013.</mixed-citation></ref><ref id="CR22"><label>22.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delyon</surname><given-names>B</given-names></name><name><surname>Lavielle</surname><given-names>M</given-names></name><name><surname>Moulines</surname><given-names>E</given-names></name></person-group><article-title>Convergence of a stochastic approximation version of the EM algorithm</article-title><source>Ann Stat</source><year>1999</year><volume>27</volume><issue>1</issue><fpage>94</fpage><lpage>128</lpage></element-citation></ref><ref id="CR23"><label>23.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Klim</surname><given-names>S</given-names></name><name><surname>Bousgaard Mortensen</surname><given-names>S</given-names></name><name><surname>Kristensen</surname><given-names>NR</given-names></name><name><surname>Overgaard</surname><given-names>RV</given-names></name><name><surname>Madsen</surname><given-names>H</given-names></name></person-group><article-title>Population stochastic modelling (PSM)&#x02014;an R package for mixed-effects models based on stochastic differential equations</article-title><source>Comput Methods Prog Biomed</source><year>2009</year><volume>94</volume><issue>3</issue><fpage>279</fpage><lpage>289</lpage></element-citation></ref><ref id="CR24"><label>24.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Mortensen</surname><given-names>S</given-names></name><name><surname>Klim</surname><given-names>S</given-names></name><name><surname>Dammann</surname><given-names>B</given-names></name><name><surname>Kristensen</surname><given-names>N</given-names></name><name><surname>Madsen</surname><given-names>H</given-names></name><name><surname>Overgaard</surname><given-names>R</given-names></name></person-group><article-title>A matlab framework for estimation of NLME models using stochastic differential equations: applications for estimation of insulin secretion rates</article-title><source>J Pharmacokinet Pharmacodyn</source><year>2007</year><volume>34</volume><issue>5</issue><fpage>623</fpage><lpage>642</lpage><pub-id pub-id-type="pmid">17571242</pub-id></element-citation></ref><ref id="CR25"><label>25.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Torn&#x000f8;e</surname><given-names>C</given-names></name><name><surname>Overgaard</surname><given-names>R</given-names></name><name><surname>Agers&#x000f8;</surname><given-names>H</given-names></name><name><surname>Nielsen</surname><given-names>H</given-names></name><name><surname>Madsen</surname><given-names>H</given-names></name><name><surname>Jonsson</surname><given-names>E</given-names></name></person-group><article-title>Stochastic differential equations in NONMEM: implementation, application, and comparison with ordinary differential equations</article-title><source>Pharm Res</source><year>2005</year><volume>22</volume><issue>8</issue><fpage>1247</fpage><lpage>1258</lpage><pub-id pub-id-type="pmid">16078134</pub-id></element-citation></ref><ref id="CR26"><label>26.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Delattre</surname><given-names>M</given-names></name><name><surname>Lavielle</surname><given-names>M</given-names></name></person-group><article-title>Coupling the SAEM algorithm and the extended Kalman filter for maximum likelihood estimation in mixed-effects diffusion models</article-title><source>Stat Interface</source><year>2013</year><volume>6</volume><fpage>519</fpage><lpage>532</lpage></element-citation></ref><ref id="CR27"><label>27.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Donnet</surname><given-names>S</given-names></name><name><surname>Samson</surname><given-names>A</given-names></name></person-group><article-title>A review on estimation of stochastic differential equations for pharmacokinetic/pharmacodynamic models</article-title><source>Adv Drug Deliv Rev</source><year>2013</year><volume>65</volume><issue>7</issue><fpage>929</fpage><lpage>939</lpage><pub-id pub-id-type="pmid">23528446</pub-id></element-citation></ref><ref id="CR28"><label>28.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Picchini</surname><given-names>U</given-names></name><name><surname>Ditlevsen</surname><given-names>S</given-names></name></person-group><article-title>Practical estimation of high dimensional stochastic differential mixed-effects models</article-title><source>Comput Stat Data Anal</source><year>2011</year><volume>55</volume><issue>3</issue><fpage>1426</fpage><lpage>1444</lpage></element-citation></ref><ref id="CR29"><label>29.</label><mixed-citation publication-type="other">Jazwinsky AH. Stochastic processes and filtering theory. Dover; 1970.</mixed-citation></ref><ref id="CR30"><label>30.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Picchini</surname><given-names>U</given-names></name><name><surname>De Gaetano</surname><given-names>A</given-names></name><name><surname>Ditlevsen</surname><given-names>S</given-names></name></person-group><article-title>Stochastic differential mixed-effects models</article-title><source>Scand J Stat</source><year>2010</year><volume>37</volume><issue>1</issue><fpage>67</fpage><lpage>90</lpage></element-citation></ref><ref id="CR31"><label>31.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Jonsson</surname><given-names>NE</given-names></name><name><surname>Karlsson</surname><given-names>MO</given-names></name><name><surname>Wade</surname><given-names>JR</given-names></name></person-group><article-title>Nonlinearity detection: advantages of nonlinear mixed-effects modeling</article-title><source>AAPS Pharm Sci</source><year>2000</year><volume>2</volume><issue>3</issue><fpage>114</fpage><lpage>123</lpage></element-citation></ref><ref id="CR32"><label>32.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Vonesh</surname><given-names>E</given-names></name></person-group><article-title>A note on the use of Laplace&#x02019;s approximation for nonlinear mixed-effects models</article-title><source>Biometrika</source><year>1996</year><volume>83</volume><issue>2</issue><fpage>447</fpage><lpage>452</lpage></element-citation></ref><ref id="CR33"><label>33.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Wang</surname><given-names>Y</given-names></name></person-group><article-title>Derivation of various NONMEM estimation methods</article-title><source>J Pharmacokinet Pharmacodyn</source><year>2007</year><volume>34</volume><issue>5</issue><fpage>575</fpage><lpage>593</lpage><pub-id pub-id-type="pmid">17620001</pub-id></element-citation></ref><ref id="CR34"><label>34.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Kalman</surname><given-names>RE</given-names></name></person-group><article-title>A new approach to linear filtering and prediction problems</article-title><source>Trans ASME J Basic Eng</source><year>1960</year><volume>82</volume><issue>Series D</issue><fpage>35</fpage><lpage>45</lpage></element-citation></ref><ref id="CR35"><label>35.</label><element-citation publication-type="book"><person-group person-group-type="author"><name><surname>Nocedal</surname><given-names>J</given-names></name></person-group><source>Wright S</source><year>1999</year><publisher-loc>Springer-Verlag New York</publisher-loc><publisher-name>Numerical optimization</publisher-name></element-citation></ref><ref id="CR36"><label>36.</label><mixed-citation publication-type="other">Ahlstr&#x000f6;m C. Modelling of tolerance and rebound in normal and diseased rats [PhD Thesis]. University of Gothenburg; 2011.</mixed-citation></ref><ref id="CR37"><label>37.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahlstr&#x000f6;m</surname><given-names>C</given-names></name><name><surname>Peletier</surname><given-names>LA</given-names></name><name><surname>Gabrielsson</surname><given-names>J</given-names></name></person-group><article-title>Quantitative analysis of rate and extent of tolerance of biomarkers: application to nicotinic acid-induced changes in non-esterified fatty acids in rats</article-title><source>Eur J Pharm Sci</source><year>2011</year><volume>44</volume><issue>3</issue><fpage>250</fpage><lpage>264</lpage><pub-id pub-id-type="pmid">21856416</pub-id></element-citation></ref><ref id="CR38"><label>38.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahlstr&#x000f6;m</surname><given-names>C</given-names></name><name><surname>Peletier</surname><given-names>LA</given-names></name><name><surname>Jansson-L&#x000f6;fmark</surname><given-names>R</given-names></name><name><surname>Gabrielsson</surname><given-names>J</given-names></name></person-group><article-title>Feedback modeling of non-esterified fatty acids in rats after nicotinic acid infusions</article-title><source>J Pharmacokinet Pharmacodyn</source><year>2011</year><volume>38</volume><issue>1</issue><fpage>1</fpage><lpage>24</lpage><pub-id pub-id-type="pmid">21046209</pub-id></element-citation></ref><ref id="CR39"><label>39.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahlstr&#x000f6;m</surname><given-names>C</given-names></name><name><surname>Kroon</surname><given-names>T</given-names></name><name><surname>Peletier</surname><given-names>LA</given-names></name><name><surname>Gabrielsson</surname><given-names>J</given-names></name></person-group><article-title>Feedback modeling of non-esterified fatty acids in obese Zucker rats after nicotinic acid infusions</article-title><source>J Pharmacokinet Pharmacodyn</source><year>2013</year><volume>40</volume><issue>6</issue><fpage>623</fpage><lpage>638</lpage><pub-id pub-id-type="pmid">24114415</pub-id></element-citation></ref><ref id="CR40"><label>40.</label><element-citation publication-type="journal"><person-group person-group-type="author"><name><surname>Ahlstr&#x000f6;m</surname><given-names>C</given-names></name><name><surname>Peletier</surname><given-names>LA</given-names></name><name><surname>Gabrielsson</surname><given-names>J</given-names></name></person-group><article-title>Challenges of a mechanistic feedback model describing nicotinic acid-induced changes in non-esterified fatty acids in rats</article-title><source>J Pharmacokinet Pharmacodyn</source><year>2013</year><volume>40</volume><issue>4</issue><fpage>497</fpage><lpage>512</lpage><pub-id pub-id-type="pmid">23824920</pub-id></element-citation></ref><ref id="CR41"><label>41.</label><mixed-citation publication-type="other">Tapani S, Almquist J, Leander J, Ahlstr&#x000f6;m C, Peletier LA, Jirstrand M, Gabrielsson J. Joint Feedback Analysis Modeling of Nonesterified Fatty Acids in Obese Zucker Rats and Normal Sprague&#x02013;Dawley Rats after Different Routes of Administration of Nicotinic Acid. J Pharm Sci. 2014;103(8):2571&#x02013;84.</mixed-citation></ref><ref id="CR42"><label>42.</label><mixed-citation publication-type="other">Bohlin T. Practical Grey-box Process Identification: Theory and Applications. Springer-Verlag;2006.</mixed-citation></ref></ref-list></back></article>